<!DOCTYPE html>
<!-- saved from url=(0077)https://www.home-assistant.io/integrations/mqtt/#birth-and-last-will-messages -->
<html lang="en"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>MQTT - Home Assistant</title>
    <meta name="author" content="Home Assistant">
    <meta name="description" content="Instructions on how to setup MQTT within Home Assistant.">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://www.home-assistant.io/integrations/mqtt/">

    <meta property="fb:app_id" content="338291289691179">
    <meta property="og:title" content="MQTT">
    <meta property="og:site_name" content="Home Assistant">
    <meta property="og:url" content="https://www.home-assistant.io/integrations/mqtt/">
    <meta property="og:type" content="article">
    <meta property="og:description" content="Instructions on how to setup MQTT within Home Assistant.">
    <meta property="og:image" content="https://www.home-assistant.io/images/default-social.png">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@home_assistant">
    
    <meta name="twitter:title" content="MQTT">
    <meta name="twitter:description" content="Instructions on how to setup MQTT within Home Assistant.">
    <meta name="twitter:image" content="https://www.home-assistant.io/images/default-social.png">
    <link rel="me" href="https://fosstodon.org/@homeassistant">

    <link href="./MQTT - Home Assistant_files/style.min.css" rel="stylesheet">
    <link href="./MQTT - Home Assistant_files/prism.css" rel="stylesheet">
    <link href="./MQTT - Home Assistant_files/screen.css" media="screen, projection, print" rel="stylesheet">
    <link href="https://www.home-assistant.io/atom.xml" rel="alternate" title="Home Assistant" type="application/atom+xml">
    <link rel="shortcut icon" href="https://www.home-assistant.io/images/favicon.ico">
    <link rel="icon" type="image/png" href="https://www.home-assistant.io/images/favicon-192x192.png" sizes="192x192">

    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="./MQTT - Home Assistant_files/css2" rel="stylesheet">
    <script src="./MQTT - Home Assistant_files/iconify-icon.min.js.download"></script>
  <script src="./MQTT - Home Assistant_files/clipboard.min.js.download"></script></head>

  <body class=" integration-page  ">
    <header class="site-header ">
      



<div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
      <a href="https://www.home-assistant.io/" class="site-title">
        <div class="logo"></div>
      </a>
      <a class="release-date" href="https://www.home-assistant.io/blog/2025/03/05/release-20253/" title="Latest version 2025.3.2 released March 11, 2025">
        2025.3.2
      </a>
    </div>

    <div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
      <nav>
        <input type="checkbox" id="toggle">
        <label for="toggle" class="toggle" data-open="Main Menu" data-close="⨉"></label>
        <ul class="menu pull-right">
          <li><a href="https://www.home-assistant.io/installation/">Getting started</a></li>
          <li>
            <a href="https://www.home-assistant.io/docs/">Documentation <iconify-icon inline="" icon="mdi:chevron-down" title="Chevron down"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 8.58L12 13.17l4.59-4.59L18 10l-6 6l-6-6z"></path></svg></template></iconify-icon></a>
            <ul>
              <li><a href="https://www.home-assistant.io/installation/"><iconify-icon inline="" icon="simple-icons:homeassistant" title="Homeassistant"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Installation</a></li>
              <li><a href="https://www.home-assistant.io/docs/automation/"><iconify-icon inline="" icon="mdi:robot-happy" title="Robot happy"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Automations</a></li>
              <li><a href="https://www.home-assistant.io/dashboards/"><iconify-icon inline="" icon="mdi:gauge" title="Gauge"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Dashboards</a></li>
              <li><a href="https://www.home-assistant.io/voice_control/"><iconify-icon inline="" icon="mdi:comment-processing-outline" title="Comment processing outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Voice assistants</a></li>
              <li><a href="https://www.home-assistant.io/docs/organizing/"><iconify-icon inline="" icon="mdi:view-grid" title="View grid"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Device organization</a></li>
              <li><a href="https://www.home-assistant.io/docs/energy/"><iconify-icon inline="" icon="mdi:solar-power-variant" title="Solar power variant"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Energy management</a></li>
              <li><a href="https://www.home-assistant.io/docs/configuration/"><iconify-icon inline="" icon="mdi:cog" title="Cog"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Advanced configuration</a></li>
            </ul>
          </li>
          <li><a class="active" href="https://www.home-assistant.io/integrations/">Integrations</a></li>
          <li><a href="https://www.home-assistant.io/blog/">Blog</a></li>
          <li><a href="https://www.home-assistant.io/help/">Need help?</a></li>
          <li>
            <div class="docsearch" id="docsearch"><button type="button" aria-label="Search (Ctrl+K)" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><svg width="20" height="20" viewBox="0 0 20 20" aria-hidden="true" class="DocSearch-Search-Icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

    </header>

    <div class="page-content">

      

      <div class="grid-wrapper">
        <div class="grid grid-center">

          <aside id="toc-bar" class="grid__item desk-wide-one-sixth">
                <section class="aside-module grid__item one-whole">
                  <div class="section">
                    <h1 class="title epsilon"><iconify-icon inline="" icon="mdi:toc" title="Toc"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M3 9h14V7H3zm0 4h14v-2H3zm0 4h14v-2H3zm16 0h2v-2h-2zm0-10v2h2V7zm0 6h2v-2h-2z"></path></svg></template></iconify-icon> On this page</h1>
                    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#removing-the-mqtt-integration">Removing the MQTT integration</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#setting-up-a-broker">Setting up a broker</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#broker-configuration">Broker configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#advanced-broker-configuration">Advanced broker configuration</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#configure-mqtt-options">Configure MQTT options</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#change-mqtt-discovery-options">Change MQTT discovery options</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-options">Discovery options</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#birth-and-last-will-messages">Birth and last will messages</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#testing-your-setup">Testing your setup</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#sharing-of-device-configuration">Sharing of device configuration</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#naming-of-mqtt-entities">Naming of MQTT Entities</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#mqtt-discovery">MQTT Discovery</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-messages">Discovery messages</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-messages-and-availability">Discovery messages and availability</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#using-availability-topics">Using Availability topics</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-examples-with-component-discovery">Discovery examples with component discovery</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#support-by-third-party-tools">Support by third-party tools</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#manual-configured-mqtt-items">Manual configured MQTT items</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#yaml-configuration-listed-per-item">YAML configuration listed per item</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#yaml-configuration-keyed-and-bundled-by-domain">YAML configuration keyed and bundled by {domain}</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#entity-state-updates">Entity state updates</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#the-last-reported-state-attribute">The last reported state attribute</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#using-templates">Using Templates</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#examples">Examples</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#publish--dump-actions">Publish &amp; Dump actions</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#action-mqttpublish">Action mqtt.publish</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#action-mqttdump">Action mqtt.dump</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#logging">Logging</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#event-event_mqtt_reloaded">Event event_mqtt_reloaded</a></li>
</ul>
                  </div>
                </section>
              </aside> 

          
          <div class="grid__item two-thirds desk-wide-seven-twelfths lap-one-whole palm-one-whole">
          

            
              <article class="page">
  
  <header>
    
    
      <div class="breadcrumbs">
        <a href="https://www.home-assistant.io/">Home</a>
        
          
            
            ▸ <a href="https://www.home-assistant.io/integrations/">Integrations</a>
          
        
          
            ▸ 
          
        
      </div>
    
    <h1 class="title indent">
      
        MQTT
      
    </h1>
  </header>
  
    
    
    
  
  
  <p>MQTT (aka MQ Telemetry Transport) is a machine-to-machine or “Internet of Things” connectivity protocol on top of TCP/IP. It allows extremely lightweight publish/subscribe messaging transport.</p>
<h2>Configuration <a class="title-link" name="configuration" href="https://www.home-assistant.io/integrations/mqtt/#configuration"></a>
</h2>
<p>To add the <strong>MQTT</strong> integration to your Home Assistant instance, use this My button:</p>
<p><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=mqtt" class="my badge" target="_blank"><img src="./MQTT - Home Assistant_files/config_flow_start.svg"></a></p>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span><iconify-icon inline="" icon="mdi:cursor-hand"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Manual configuration steps</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_0">
<p>If the above My button doesn’t work, you can also perform the following steps
manually:</p>
<ul>
<li>
<p>Browse to your Home Assistant instance.</p>
</li>
<li>
<p>Go to <strong><a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank"><iconify-icon inline="" icon="mdi:devices"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Settings &gt; Devices &amp; Services</a></strong>.</p>
</li>
<li>
<p>In the bottom right corner, select the
<strong><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=mqtt" class="my" target="_blank"><iconify-icon inline="" icon="mdi:plus"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Add Integration</a></strong> button.</p>
</li>
<li>
<p>From the list, select <strong>MQTT</strong>.</p>
</li>
<li>
<p>Follow the instructions on screen to complete the setup.</p>
</li>
</ul>
</div>
  </details>
</div>
<h3>Removing the MQTT integration <a class="title-link" name="removing-the-mqtt-integration" href="https://www.home-assistant.io/integrations/mqtt/#removing-the-mqtt-integration"></a>
</h3>
<p>The MQTT integration and its entities can be removed by following these steps:</p>
<ol>
<li>Navigate to <strong>Settings</strong> &gt; <strong>Devices &amp; Services</strong>
</li>
<li>Find the MQTT integration and click on it</li>
<li>Click the delete button to remove the MQTT config entry</li>
</ol>
<p>Note: This action does not remove the <a href="https://www.home-assistant.io/integrations/mqtt/#setting-up-a-broker">MQTT broker</a> or its data. If you want to completely remove MQTT:</p>
<ol>
<li>Check your <code>configuration.yaml</code> and other YAML files for MQTT-related configurations and remove them</li>
<li>Review your automations and scripts for any MQTT dependencies</li>
<li>Consider backing up your configuration before making these changes</li>
</ol>
<p><a name="configuration-via-mqtt-discovery"></a></p>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span>Configuration of MQTT components via MQTT discovery</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_0">
<ul>
<li><a href="https://www.home-assistant.io/integrations/alarm_control_panel.mqtt/">Alarm control panel</a></li>
<li><a href="https://www.home-assistant.io/integrations/binary_sensor.mqtt/">Binary sensor</a></li>
<li><a href="https://www.home-assistant.io/integrations/button.mqtt/">Button</a></li>
<li><a href="https://www.home-assistant.io/integrations/camera.mqtt/">Camera</a></li>
<li><a href="https://www.home-assistant.io/integrations/cover.mqtt/">Cover</a></li>
<li><a href="https://www.home-assistant.io/integrations/device_tracker.mqtt/">Device tracker</a></li>
<li><a href="https://www.home-assistant.io/integrations/device_trigger.mqtt/">Device trigger</a></li>
<li><a href="https://www.home-assistant.io/integrations/event.mqtt/">Event</a></li>
<li><a href="https://www.home-assistant.io/integrations/fan.mqtt/">Fan</a></li>
<li><a href="https://www.home-assistant.io/integrations/humidifier.mqtt/">Humidifier</a></li>
<li><a href="https://www.home-assistant.io/integrations/image.mqtt/">Image</a></li>
<li><a href="https://www.home-assistant.io/integrations/climate.mqtt/">Climate/HVAC</a></li>
<li><a href="https://www.home-assistant.io/integrations/lawn_mower.mqtt/">Lawn mower</a></li>
<li><a href="https://www.home-assistant.io/integrations/light.mqtt/">Light</a></li>
<li><a href="https://www.home-assistant.io/integrations/lock.mqtt/">Lock</a></li>
<li><a href="https://www.home-assistant.io/integrations/notify.mqtt/">Notify</a></li>
<li><a href="https://www.home-assistant.io/integrations/number.mqtt/">Number</a></li>
<li><a href="https://www.home-assistant.io/integrations/scene.mqtt/">Scene</a></li>
<li><a href="https://www.home-assistant.io/integrations/select.mqtt/">Select</a></li>
<li><a href="https://www.home-assistant.io/integrations/sensor.mqtt/">Sensor</a></li>
<li><a href="https://www.home-assistant.io/integrations/siren.mqtt/">Siren</a></li>
<li><a href="https://www.home-assistant.io/integrations/switch.mqtt/">Switch</a></li>
<li><a href="https://www.home-assistant.io/integrations/update.mqtt/">Update</a></li>
<li><a href="https://www.home-assistant.io/integrations/tag.mqtt/">Tag scanner</a></li>
<li><a href="https://www.home-assistant.io/integrations/text.mqtt/">Text</a></li>
<li><a href="https://www.home-assistant.io/integrations/vacuum.mqtt/">Vacuum</a></li>
<li><a href="https://www.home-assistant.io/integrations/valve.mqtt/">Valve</a></li>
<li><a href="https://www.home-assistant.io/integrations/water_heater.mqtt/">Water heater</a></li>
</ul>
</div>
  </details>
</div>
<p><a name="configuration-via-yaml"></a></p>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span>Configuration of MQTT components via YAML</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_1">
<ul>
<li><a href="https://www.home-assistant.io/integrations/alarm_control_panel.mqtt/">Alarm control panel</a></li>
<li><a href="https://www.home-assistant.io/integrations/binary_sensor.mqtt/">Binary sensor</a></li>
<li><a href="https://www.home-assistant.io/integrations/button.mqtt/">Button</a></li>
<li><a href="https://www.home-assistant.io/integrations/camera.mqtt/">Camera</a></li>
<li><a href="https://www.home-assistant.io/integrations/cover.mqtt/">Cover</a></li>
<li><a href="https://www.home-assistant.io/integrations/device_tracker.mqtt/">Device tracker</a></li>
<li><a href="https://www.home-assistant.io/integrations/event.mqtt/">Event</a></li>
<li><a href="https://www.home-assistant.io/integrations/fan.mqtt/">Fan</a></li>
<li><a href="https://www.home-assistant.io/integrations/humidifier.mqtt/">Humidifier</a></li>
<li><a href="https://www.home-assistant.io/integrations/image.mqtt/">Image</a></li>
<li><a href="https://www.home-assistant.io/integrations/climate.mqtt/">Climate/HVACs</a></li>
<li><a href="https://www.home-assistant.io/integrations/lawn_mower.mqtt/">Lawn mower</a></li>
<li><a href="https://www.home-assistant.io/integrations/light.mqtt/">Light</a></li>
<li><a href="https://www.home-assistant.io/integrations/lock.mqtt/">Lock</a></li>
<li><a href="https://www.home-assistant.io/integrations/notify.mqtt/">Notify</a></li>
<li><a href="https://www.home-assistant.io/integrations/number.mqtt/">Number</a></li>
<li><a href="https://www.home-assistant.io/integrations/scene.mqtt/">Scene</a></li>
<li><a href="https://www.home-assistant.io/integrations/select.mqtt/">Select</a></li>
<li><a href="https://www.home-assistant.io/integrations/sensor.mqtt/">Sensor</a></li>
<li><a href="https://www.home-assistant.io/integrations/siren.mqtt/">Siren</a></li>
<li><a href="https://www.home-assistant.io/integrations/switch.mqtt/">Switch</a></li>
<li><a href="https://www.home-assistant.io/integrations/text.mqtt/">Text</a></li>
<li><a href="https://www.home-assistant.io/integrations/update.mqtt/">Update</a></li>
<li><a href="https://www.home-assistant.io/integrations/vacuum.mqtt/">Vacuum</a></li>
<li><a href="https://www.home-assistant.io/integrations/valve.mqtt/">Valve</a></li>
<li><a href="https://www.home-assistant.io/integrations/water_heater.mqtt/">Water heater</a></li>
</ul>
</div>
  </details>
</div>
<p>Your first step to get MQTT and Home Assistant working is to choose a broker.</p>
<p>The easiest option is to install the official Mosquitto Broker add-on. You can choose to set up and configure this add-on automatically when you set up the MQTT integration. Home Assistant will automatically generate and assign a safe username and password, and no further attention is required. This also works if you have already set up this add-on yourself in advance.
You can set up additional logins for your MQTT devices and services using the <a href="https://my.home-assistant.io/redirect/supervisor_addon/?addon=core_mosquitto">Mosquitto add-on configuration</a>.</p>
<div class="alert alert-important">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:message-alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Important</p>
  <p class="alert-content">
</p>
<p>When MQTT is set up with the official Mosquitto MQTT broker add-on, the broker’s credentials are generated and kept secret. If the official Mosquitto MQTT broker needs to be re-installed, make sure you save a copy of the add-on user options, like the additional logins. After re-installing the add-on, the MQTT integration will automatically update the new password for the re-installed broker. It will then reconnect automatically.</p>
  
</div>
<p>Alternatively, you can use a different MQTT broker that you configure yourself, ensuring it is compatible with Home Assistant.</p>
<h2>Setting up a broker <a class="title-link" name="setting-up-a-broker" href="https://www.home-assistant.io/integrations/mqtt/#setting-up-a-broker"></a>
</h2>
<p>While public MQTT brokers are available, the easiest and most private option is running your own.</p>
<p>The recommended setup method is to use the <a href="https://github.com/home-assistant/hassio-addons/blob/master/mosquitto/DOCS.md" rel="external nofollow">Mosquitto MQTT broker add-on<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a>.</p>
<div class="alert alert-warning">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Warning</p>
  <p class="alert-content">
</p>
<p>Neither ActiveMQ MQTT broker nor the RabbitMQ MQTT Plugin are supported, use a known working broker like Mosquitto instead.
There are <a href="https://issues.apache.org/jira/browse/AMQ-6360" rel="external nofollow">at least two<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> <a href="https://issues.apache.org/jira/browse/AMQ-6575" rel="external nofollow">issues<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> with the ActiveMQ MQTT broker which break MQTT message retention.</p>
  
</div>
<h2>Broker configuration <a class="title-link" name="broker-configuration" href="https://www.home-assistant.io/integrations/mqtt/#broker-configuration"></a>
</h2>
<p>MQTT broker settings are configured when the MQTT integration is first set up and can be changed later if needed.</p>
<p>Add the MQTT integration, then provide your broker’s hostname (or IP address) and port and (if required) the username and password that Home Assistant should use. To change the settings later, follow these steps:</p>
<ol>
<li>Go to <strong><a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank">Settings &gt; Devices &amp; services</a></strong>.</li>
<li>Select the MQTT integration.</li>
<li>Reconfigure the MQTT broker settings via <a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank"><strong>Settings</strong> &gt; <strong>Devices &amp; services</strong></a>, click <iconify-icon inline="" icon="mdi:dots-vertical" title="Dots vertical"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> and select <strong>Reconfigure</strong>.</li>
</ol>
<div class="alert alert-important">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:message-alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Important</p>
  <p class="alert-content">
</p>
<p>If you experience an error message like <code>Failed to connect due to exception: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed</code>, then turn on <code>Advanced options</code> and set <a href="https://www.home-assistant.io/integrations/mqtt/#broker-certificate-validation">Broker certificate validation</a> to <code>Auto</code>.</p>
  
</div>
<h3>Advanced broker configuration <a class="title-link" name="advanced-broker-configuration" href="https://www.home-assistant.io/integrations/mqtt/#advanced-broker-configuration"></a>
</h3>
<p>Advanced broker configuration options include setting a custom client ID, setting a client certificate and key for authentication, and enabling TLS validation of the broker’s certificate for secure connection. To access the advanced settings, open the MQTT broker settings, switch on <code>Advanced options</code> and click <code>Next</code>. The advanced options will be shown by default if there are advanced settings active already.</p>
<div class="alert alert-tip">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:lightbulb-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Tip</p>
  <p class="alert-content">
</p>
<p>Advanced broker options are accessible only when advanced mode is enabled (see user settings), or when advanced broker settings are configured already.</p>
  
</div>
<h4>Alternative client ID <a class="title-link" name="alternative-client-id" href="https://www.home-assistant.io/integrations/mqtt/#alternative-client-id"></a>
</h4>
<p>You can set a custom MQTT client ID, this can help when debugging. Mind that the client ID must be unique. Leave this settings default if you want Home Assistant to generate a unique ID.</p>
<h4>Keep alive <a class="title-link" name="keep-alive" href="https://www.home-assistant.io/integrations/mqtt/#keep-alive"></a>
</h4>
<p>The time in seconds between sending keep alive messages for this client. The default is 60 seconds. The keep alive setting should be minimal 15 seconds.</p>
<h4>Broker certificate validation <a class="title-link" name="broker-certificate-validation" href="https://www.home-assistant.io/integrations/mqtt/#broker-certificate-validation"></a>
</h4>
<p>To enable a secure connection to the broker, the broker certificate should be validated. If your broker uses a trusted certificate, then choose <code>Auto</code>. This will allow validation against certificate CAs bundled certificates. If a self-signed certificate is used, select <code>Custom</code>. A custom PEM-encoded CA certificate can be uploaded. Click <code>NEXT</code> to show the control to upload the CA certificate.
If the server certificate does not match the hostname then validation will fail. To allow a connection without the verification of the hostname, turn the <code>Ignore broker certificate validation</code> switch on.</p>
<h4>MQTT Protocol <a class="title-link" name="mqtt-protocol" href="https://www.home-assistant.io/integrations/mqtt/#mqtt-protocol"></a>
</h4>
<p>The MQTT protocol setting defaults to version <code>3.1.1</code>. If your MQTT broker supports MQTT version 5 you can set the protocol setting to <code>5</code>.</p>
<h4>Securing the connection <a class="title-link" name="securing-the-connection" href="https://www.home-assistant.io/integrations/mqtt/#securing-the-connection"></a>
</h4>
<p>With a secure broker connection it is possible to use a client certificate for authentication. To set the client certificate and private key turn on the option <code>Use a client certificate</code> and click “Next” to show the controls to upload the files. Only a PEM encoded client certificates together with a PEM encoded private key can be uploaded. Make sure the private key has no password set.</p>
<h4>Using WebSockets as transport <a class="title-link" name="using-websockets-as-transport" href="https://www.home-assistant.io/integrations/mqtt/#using-websockets-as-transport"></a>
</h4>
<p>You can select <code>websockets</code> as transport method if your MQTT broker supports it. When you select <code>websockets</code> and click <code>NEXT</code>, you will be able to add a WebSockets path (default = <code>/</code>) and WebSockets headers (optional). The target WebSockets URI: <code>ws://{broker}:{port}{WebSockets path}</code> is built with <code>broker</code>, <code>port</code> and <code>ws_path</code> (WebSocket path) settings.
To configure the WebSocket’s headers supply a valid JSON dictionary string. E.g. <code>{ "Authorization": "token" , "x-header": "some header"}</code>. The default transport method is <code>tcp</code>. The WebSockets transport can be secured using TLS and optionally using user credentials or a client certificate.</p>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:information-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Note</p>
  <p class="alert-content">
</p>
<p>A configured client certificate will only be active if broker certificate validation is enabled.</p>
  
</div>
<h2>Configure MQTT options <a class="title-link" name="configure-mqtt-options" href="https://www.home-assistant.io/integrations/mqtt/#configure-mqtt-options"></a>
</h2>
<p>To change the options, follow these steps:</p>
<ol>
<li>Go to <strong><a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank">Settings &gt; Devices &amp; services</a></strong>.</li>
<li>Select the MQTT integration.</li>
<li>Select <strong>Configure</strong>, then <strong>Re-configure MQTT</strong>.</li>
<li>To open the MQTT options page, select <strong>Next</strong>.</li>
</ol>
<h3>Change MQTT discovery options <a class="title-link" name="change-mqtt-discovery-options" href="https://www.home-assistant.io/integrations/mqtt/#change-mqtt-discovery-options"></a>
</h3>
<p>The MQTT discovery options can be changed by following these steps:</p>
<ol>
<li>Go to <a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank"><strong>Settings</strong> &gt; <strong>Devices &amp; services</strong></a>.</li>
<li>Find the MQTT integration and select it.</li>
<li>To open the MQTT discovery options page, select the <strong>Configure MQTT Options</strong> button.</li>
</ol>
<h3>Discovery options <a class="title-link" name="discovery-options" href="https://www.home-assistant.io/integrations/mqtt/#discovery-options"></a>
</h3>
<p>MQTT discovery is enabled by default. Discovery can be turned off. The prefix for the discovery topic (default <code>homeassistant</code>) can be changed here as well.
See also <a href="https://www.home-assistant.io/integrations/mqtt/#mqtt-discovery">MQTT Discovery section</a></p>
<h3>Birth and last will messages <a class="title-link" name="birth-and-last-will-messages" href="https://www.home-assistant.io/integrations/mqtt/#birth-and-last-will-messages"></a>
</h3>
<p>Home Assistant’s MQTT integration supports so-called Birth and Last Will and Testament (LWT) messages. The former is used to send a message after the service has started, and the latter is used to notify other clients about a disconnected client. Please note that the LWT message will be sent both in case of a clean (e.g. Home Assistant shutting down) and in case of an unclean (e.g. Home Assistant crashing or losing its network connection) disconnect.</p>
<p>If a disabled entity is enabled and added after 30 seconds, the MQTT integration will be reloaded and will cause all discovered MQTT entities to be unloaded.
When MQTT starts up, all existing MQTT devices, entities, tags, and device triggers, will be unavailable until a discovery message is received and processed. A device or service that exposes the MQTT discovery should subscribe to the Birth message and use this as a trigger to send the <a href="https://www.home-assistant.io/integrations/mqtt/#discovery-payload">discovery payload</a>. To avoid high IO loads on the MQTT broker, adding some random delay in sending the discovery payload is recommended.</p>
<p>Alternative approaches:</p>
<ul>
<li>Retaining the <a href="https://www.home-assistant.io/integrations/mqtt/#discovery-payload">discovery payload</a>: This will store the discovery payload at the MQTT broker, and offer it to the MQTT integration as soon as it subscribes for MQTT discovery. When there are a lot of entities, this can cause high IO loads.</li>
<li>Periodically resending the discovery payload: This can cause some delay, or a lot of IO if there are a lot of MQTT discovery messages.</li>
</ul>
<p>By default, Home Assistant sends <code>online</code> and <code>offline</code> to <code>homeassistant/status</code>.</p>
<p>MQTT Birth and Last Will messages can be customized or disabled from the UI. To do this, click on “Configure” in the integration page in the UI, then “Re-configure MQTT” and then “Next”.</p>
<h2>Testing your setup <a class="title-link" name="testing-your-setup" href="https://www.home-assistant.io/integrations/mqtt/#testing-your-setup"></a>
</h2>
<p>The <code>mosquitto</code> broker package ships command line tools (often as <code>*-clients</code> package) to send and receive MQTT messages. For sending test messages to a broker running on <code>localhost</code>, you can use <a href="https://mosquitto.org/man/mosquitto_pub-1.html" rel="external nofollow"><code>mosquitto_pub</code><iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a>, check the example below:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_pub -h <span class="token number">127.0</span>.0.1 -t homeassistant/switch/1/on -m <span class="token string">"Switch is ON"</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Another way to send MQTT messages manually is to use the <strong>MQTT</strong> integration in the frontend. Choose “Settings” on the left menu, click “Devices &amp; services”, and choose “Configure” in the “Mosquitto broker” tile. Enter something similar to the example below into the “topic” field under “Publish a packet” and press “PUBLISH” .</p>
<ol>
<li>Go to <strong><a href="https://my.home-assistant.io/redirect/integrations" class="my" target="_blank">Settings &gt; Devices &amp; services</a></strong>.</li>
<li>Select the Mosquitto broker integration, then select <strong>Configure</strong>.</li>
<li>Enter something similar to the example below into the <strong>topic</strong> field under <strong>Publish a packet</strong>. Select <strong>Publish</strong>.</li>
</ol>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">homeassistant/switch/1/power</code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>and in the Payload field</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">ON</code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>In the “Listen to a topic” field, type <code>#</code> to see everything, or “homeassistant/switch/#” to just follow a published topic, then press “START LISTENING”. The messages should appear similar to the text below:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">Message <span class="token number">23</span> received on homeassistant/switch/1/power/stat/POWER at <span class="token number">12</span>:16 PM:
ON
QoS: <span class="token number">0</span> - Retain: <span class="token boolean">false</span>
Message <span class="token number">22</span> received on homeassistant/switch/1/power/stat/RESULT at <span class="token number">12</span>:16 PM:
<span class="token punctuation">{</span>
    <span class="token string">"POWER"</span><span class="token builtin class-name">:</span> <span class="token string">"ON"</span>
<span class="token punctuation">}</span>
QoS: <span class="token number">0</span> - Retain: <span class="token boolean">false</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>For reading all messages sent on the topic <code>homeassistant</code> to a broker running on localhost:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_sub -h <span class="token number">127.0</span>.0.1 -v -t <span class="token string">"homeassistant/#"</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h2>Sharing of device configuration <a class="title-link" name="sharing-of-device-configuration" href="https://www.home-assistant.io/integrations/mqtt/#sharing-of-device-configuration"></a>
</h2>
<p>MQTT entities can share device configuration, meaning one entity can include the full device configuration and other entities can link to that device by only setting mandatory fields.
The mandatory fields were previously limited to at least one of <code>connection</code> and <code>identifiers</code>, but have now been extended to at least one of <code>connection</code> and <code>identifiers</code> as well as the <code>name</code>.</p>
<h2>Naming of MQTT Entities <a class="title-link" name="naming-of-mqtt-entities" href="https://www.home-assistant.io/integrations/mqtt/#naming-of-mqtt-entities"></a>
</h2>
<p>For every configured MQTT entity Home Assistant automatically assigns a unique <code>entity_id</code>. If the <code>unique_id</code> option is configured, you can change the <code>entity_id</code> after creation, and the changes are stored in the Entity Registry. The <code>entity_id</code> is generated when an item is loaded the first time.</p>
<p>If the <code>object_id</code> option is set, then this will be used to generate the <code>entity_id</code>.
If, for example, we have configured a <code>sensor</code>, and we have set <code>object_id</code> to <code>test</code>, then Home Assistant will try to assign <code>sensor.test</code> as <code>entity_id</code>, but if this <code>entity_id</code> already exits it will append it with a suffix to make it unique, for example, <code>sensor.test_2</code>.</p>
<p>This means any MQTT entity which is part of a device will <a href="https://developers.home-assistant.io/docs/core/entity/#has_entity_name-true-mandatory-for-new-integrations">automatically have its <code>friendly_name</code> attribute prefixed with the device name</a></p>
<p>Unnamed <code>binary_sensor</code>, <code>button</code>, <code>number</code> and <code>sensor</code> entities will now be named by their device class instead of being named “MQTT binary sensor” etc.
It’s allowed to set an MQTT entity’s name to <code>None</code> (use <code>null</code> in YAML) to mark it as the main feature of a device.</p>
<p>Note that on each MQTT entity, the <code>has_entity_name</code> attribute will be set to <code>True</code>. More details <a href="https://developers.home-assistant.io/docs/core/entity/#has_entity_name-true-mandatory-for-new-integrations">can be found here</a>.</p>
<h2>MQTT Discovery <a class="title-link" name="mqtt-discovery" href="https://www.home-assistant.io/integrations/mqtt/#mqtt-discovery"></a>
</h2>
<p>The discovery of MQTT devices will enable one to use MQTT devices with only minimal configuration effort on the side of Home Assistant. The configuration is done on the device itself and the topic used by the device. Similar to the <a href="https://www.home-assistant.io/integrations/http/#binary-sensor">HTTP binary sensor</a> and the <a href="https://www.home-assistant.io/integrations/http/#sensor">HTTP sensor</a>. To prevent multiple identical entries if a device reconnects, a unique identifier is necessary. Two parts are required on the device side: The configuration topic which contains the necessary device type and unique identifier, and the remaining device configuration without the device type.</p>
<p>MQTT discovery is enabled by default, but can be disabled. The prefix for the discovery topic (default <code>homeassistant</code>) can be changed.
See the <a href="https://www.home-assistant.io/integrations/mqtt/#configure-mqtt-options">MQTT Options sections</a></p>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:information-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Note</p>
  <p class="alert-content">
</p>
<p>Documentation on the MQTT components that support MQTT discovery <a href="https://www.home-assistant.io/integrations/mqtt/#configuration-via-mqtt-discovery">can be found here</a>.</p>
  
</div>
<h3>Discovery messages <a class="title-link" name="discovery-messages" href="https://www.home-assistant.io/integrations/mqtt/#discovery-messages"></a>
</h3>
<h4>Discovery topic <a class="title-link" name="discovery-topic" href="https://www.home-assistant.io/integrations/mqtt/#discovery-topic"></a>
</h4>
<p>The discovery topic needs to follow a specific format:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-text"><code data-lang="text" class=" language-text">&lt;discovery_prefix&gt;/&lt;component&gt;/[&lt;node_id&gt;/]&lt;object_id&gt;/config</code></pre><div class="toolbar"><div class="toolbar-item"><span>Text</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<ul>
<li>
<code>&lt;discovery_prefix&gt;</code>: The Discovery Prefix defaults to <code>homeassistant</code> and this prefix can be <a href="https://www.home-assistant.io/integrations/mqtt/#discovery-options">changed</a>.</li>
<li>
<code>&lt;component&gt;</code>: One of the supported MQTT integrations, e.g., <code>binary_sensor</code>, or <code>device</code> in case of a device discovery.</li>
<li>
<code>&lt;node_id&gt;</code>: (<em>Optional</em>):  ID of the node providing the topic, this is not used by Home Assistant but may be used to structure the MQTT topic. The ID of the node must only consist of characters from the character class <code>[a-zA-Z0-9_-]</code> (alphanumerics, underscore and hyphen).</li>
<li>
<code>&lt;object_id&gt;</code>: The ID of the device. This is only to allow for separate topics for each device and is not used for the <code>entity_id</code>. The ID of the device must only consist of characters from the character class <code>[a-zA-Z0-9_-]</code> (alphanumerics, underscore and hyphen).</li>
</ul>
<p>The <code>&lt;node_id&gt;</code> level can be used by clients to only subscribe to their own (command) topics by using one wildcard topic like <code>&lt;discovery_prefix&gt;/+/&lt;node_id&gt;/+/set</code>.</p>
<p>Best practice for entities with a <code>unique_id</code> is to set <code>&lt;object_id&gt;</code> to <code>unique_id</code> and omit the <code>&lt;node_id&gt;</code>.</p>
<h4>Device discovery payload <a class="title-link" name="device-discovery-payload" href="https://www.home-assistant.io/integrations/mqtt/#device-discovery-payload"></a>
</h4>
<p>A device can send a discovery payload to expose all components for a device.
The <code>&lt;component&gt;</code> part in the discovery topic must be set to <code>device</code>.</p>
<p>As an alternative, it is also possible a device <a href="https://www.home-assistant.io/integrations/mqtt/#single-component-discovery-payload">can send a discovery payload for each component</a> it wants to set up.</p>
<p>The shared options at the root level of the JSON message must include:</p>
<ul>
<li>
<code>device</code> mapping (abbreviated as <code>dev</code>)</li>
<li>
<code>origin</code> mapping (abbreviated as <code>o</code>)</li>
</ul>
<p>These mappings are mandatory and cannot be overridden at the entity/component level.</p>
<p>Supported shared options are:</p>
<ul>
<li>The <code>availability</code> <a href="https://www.home-assistant.io/integrations/mqtt/#using-availability-topics">options</a>.</li>
<li>The <code>origin</code> (required) <a href="https://www.home-assistant.io/integrations/mqtt/#adding-information-about-the-origin-of-a-discovery-message">options</a>
</li>
<li><code>command_topic</code></li>
<li><code>state_topic</code></li>
<li><code>qos</code></li>
<li><code>encoding</code></li>
</ul>
<p>The component specific options are placed as mappings under the <code>components</code> key (abbreviated as <code>cmp</code>) like:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ids"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span>
    <span class="token property">"mf"</span><span class="token operator">:</span> <span class="token string">"Bla electronics"</span><span class="token punctuation">,</span>
    <span class="token property">"mdl"</span><span class="token operator">:</span> <span class="token string">"xya"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"sn"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1.0rev2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"bla2mqtt"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"<a class="token url-link" href="https://bla2mqtt.example.com/support">https://bla2mqtt.example.com/support</a>"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"cmps"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"some_unique_component_id1"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"sensor"</span><span class="token punctuation">,</span>
      <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"temperature"</span><span class="token punctuation">,</span>
      <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"°C"</span><span class="token punctuation">,</span>
      <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.temperature}}"</span><span class="token punctuation">,</span>
      <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"temp01ae_t"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"some_unique_id2"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"sensor"</span><span class="token punctuation">,</span>
      <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"humidity"</span><span class="token punctuation">,</span>
      <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"%"</span><span class="token punctuation">,</span>
      <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.humidity}}"</span><span class="token punctuation">,</span>
      <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"temp01ae_h"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"sensorBedroom/state"</span><span class="token punctuation">,</span>
  <span class="token property">"qos"</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>The components id’s under the <code>components</code> (<code>cmp</code>) key, are used as part of the discovery identification. A <code>platform</code> (<code>p</code>) config option is required for each component config that is added to identify the component platform. Also required is a <code>unique_id</code> for entity-based components.</p>
<p>To remove the components, publish an empty (retained) string payload to the discovery topic. This will remove the component and clear the published discovery payload. It will also remove the device entry if there are no further references to it.</p>
<p>An empty config can be published as an update to remove a single component from the device discovery. Note that adding the <code>platform</code> (<code>p</code>) option is still required.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ids"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span>
    <span class="token property">"mf"</span><span class="token operator">:</span> <span class="token string">"Bla electronics"</span><span class="token punctuation">,</span>
    <span class="token property">"mdl"</span><span class="token operator">:</span> <span class="token string">"xya"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"sn"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1.0rev2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"bla2mqtt"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"<a class="token url-link" href="https://bla2mqtt.example.com/support">https://bla2mqtt.example.com/support</a>"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"cmps"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"some_unique_component_id1"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"sensor"</span><span class="token punctuation">,</span>
      <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"temperature"</span><span class="token punctuation">,</span>
      <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"°C"</span><span class="token punctuation">,</span>
      <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.temperature}}"</span><span class="token punctuation">,</span>
      <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"temp01ae_t"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"some_unique_id2"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"sensor"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"sensorBedroom/state"</span><span class="token punctuation">,</span>
  <span class="token property">"qos"</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>This will explicitly remove the humidity sensor and its entry.</p>
<p>After removing a component, you should send another update with the removed component omitted from the configuration. This ensures that Home Assistant has the most up-to-date device configuration. For example:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ids"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span>
    <span class="token property">"mf"</span><span class="token operator">:</span> <span class="token string">"Bla electronics"</span><span class="token punctuation">,</span>
    <span class="token property">"mdl"</span><span class="token operator">:</span> <span class="token string">"xya"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"sn"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1.0rev2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"bla2mqtt"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"<a class="token url-link" href="https://bla2mqtt.example.com/support">https://bla2mqtt.example.com/support</a>"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"cmps"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"some_unique_component_id1"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"sensor"</span><span class="token punctuation">,</span>
      <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"temperature"</span><span class="token punctuation">,</span>
      <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"°C"</span><span class="token punctuation">,</span>
      <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.temperature}}"</span><span class="token punctuation">,</span>
      <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"temp01ae_t"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"sensorBedroom/state"</span><span class="token punctuation">,</span>
  <span class="token property">"qos"</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<div class="note warning">
<p>A component config part in a device discovery payload must have the <code>platform</code> (<code>p</code>) option set with the name of the <code>component</code> and also must have at least one component specific config option. Entity components must have set the <code>unique_id</code> option and have a <code>device</code> context.</p>
</div>
<h5>Migration from single component to device-based discovery <a class="title-link" name="migration-from-single-component-to-device-based-discovery" href="https://www.home-assistant.io/integrations/mqtt/#migration-from-single-component-to-device-based-discovery"></a>
</h5>
<p>To allow a smooth migration from single component discovery to device-based discovery:</p>
<ol>
<li>Ensure all entities have a <code>unique_id</code> and a <code>device</code> context.</li>
<li>Move the <code>object_id</code> inside the discovery payload, if that is available, or use a unique ID or the component.</li>
<li>Consider using the previous <code>node_id</code> as the new <code>object_id</code> of the device discovery topic.</li>
<li>Ensure the <code>unique_id</code> matches and the <code>device</code> context has the correct identifiers.</li>
<li>Send the following payload to all existing single component discovery topics: <code>{"migrate_discovery": true }</code>. This will unload the discovered item, but its settings will be retained.</li>
<li>Switch the discovery topic to the device-based discovery topic and include all the component configurations.</li>
<li>Clean up the single component discovery messages with an empty payload.</li>
</ol>
<p>During the migration steps, INFO messages will be logged to inform you about the progress of the migration.</p>
<div class="alert alert-important">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:message-alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Important</p>
  <p class="alert-content">
</p>
<p>Consider testing the migration process in a non-production environment before applying it to a live system.</p>
  
</div>
<h4>Discovery migration example with a device automation and a sensor <a class="title-link" name="discovery-migration-example-with-a-device-automation-and-a-sensor" href="https://www.home-assistant.io/integrations/mqtt/#discovery-migration-example-with-a-device-automation-and-a-sensor"></a>
</h4>
<p><strong>Step 1: Original single component discovery configurations:</strong></p>
<p>Discovery topic single: <code>homeassistant/device_automation/0AFFD2/bla1/config</code>
Discovery id: <code>0AFFD2 bla1</code> <em>(both <code>0AFFD2</code> and <code>bla1</code> from the discovery topic)</em>
Discovery payload single:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"device"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"identifiers"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"0AFFD2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Test device"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"foobar"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"automation_type"</span><span class="token operator">:</span> <span class="token string">"trigger"</span><span class="token punctuation">,</span>
  <span class="token property">"payload"</span><span class="token operator">:</span> <span class="token string">"short_press"</span><span class="token punctuation">,</span>
  <span class="token property">"topic"</span><span class="token operator">:</span> <span class="token string">"foobar/triggers/button1"</span><span class="token punctuation">,</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"button_short_press"</span><span class="token punctuation">,</span>
  <span class="token property">"subtype"</span><span class="token operator">:</span> <span class="token string">"button_1"</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Discovery topic single: <code>homeassistant/sensor/0AFFD2/bla2/config</code>
Discovery id: <code>0AFFD2 bla2</code> <em>(both <code>0AFFD2</code> and <code>bla2</code> from the discovery topic)</em>
Discovery payload single:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"device"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"identifiers"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"0AFFD2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Test device"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"foobar"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"state_topic"</span><span class="token operator">:</span> <span class="token string">"foobar/sensor/sensor1"</span><span class="token punctuation">,</span>
  <span class="token property">"unique_id"</span><span class="token operator">:</span> <span class="token string">"bla_sensor001"</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p><strong>Step 2: Initiate migration by publishing to both discovery topics:</strong></p>
<p>When these single component discovery payloads are processed, and we want to initiate migration to a device-based discovery, we need to publish …</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span><span class="token property">"migrate_discovery"</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>… to both discovery topics …</p>
<ul>
<li><code>homeassistant/device_automation/0AFFD2/bla1/config</code></li>
<li><code>homeassistant/sensor/0AFFD2/bla2/config</code></li>
</ul>
<div class="alert alert-important">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:message-alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Important</p>
  <p class="alert-content">
</p>
<p>Check the logs to ensure this step is executed correctly.</p>
  
</div>
<p><strong>Step 3: Publish the new device-based discovery configuration:</strong></p>
<p>Discovery topic device: <code>homeassistant/device/0AFFD2/config</code>
Discovery id: <code>0AFFD2 bla</code> <em>(<code>0AFFD2</code>from discovery topic, <code>bla</code>: The key under <code>cmp</code> in the discovery payload)</em>
Discovery payload device:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"device"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"identifiers"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"0AFFD2"</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"foobar"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"cmps"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"bla1"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"device_automation"</span><span class="token punctuation">,</span>
      <span class="token property">"automation_type"</span><span class="token operator">:</span> <span class="token string">"trigger"</span><span class="token punctuation">,</span>
      <span class="token property">"payload"</span><span class="token operator">:</span> <span class="token string">"short_press"</span><span class="token punctuation">,</span>
      <span class="token property">"topic"</span><span class="token operator">:</span> <span class="token string">"foobar/triggers/button1"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"button_short_press"</span><span class="token punctuation">,</span>
      <span class="token property">"subtype"</span><span class="token operator">:</span> <span class="token string">"button_1"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"bla2"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"sensor"</span><span class="token punctuation">,</span>
      <span class="token property">"state_topic"</span><span class="token operator">:</span> <span class="token string">"foobar/sensor/sensor1"</span><span class="token punctuation">,</span>
      <span class="token property">"unique_id"</span><span class="token operator">:</span> <span class="token string">"bla_sensor001"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<div class="alert alert-important">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:message-alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Important</p>
  <p class="alert-content">
</p>
<p>Check the logs to ensure the migration was successful.</p>
  
</div>
<p><strong>Step 4: Clean up after successful migration:</strong></p>
<p>After the logs show a successful migration, the single component discovery topics can be cleaned up safely by publishing an empty payload to them.
The logs should indicate if the discovery migration was successful.</p>
<p><strong>Optional: Rolling back the migration:</strong></p>
<p>To rollback publish …</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span><span class="token property">"migrate_discovery"</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>To the device-based discovery topic(s).
After that, re-publish the single component discovery payloads.
At last, clean up the device-based discovery payloads by publishing an empty payload.</p>
<p>Check the logs for every step.</p>
<h4>Single component discovery payload <a class="title-link" name="single-component-discovery-payload" href="https://www.home-assistant.io/integrations/mqtt/#single-component-discovery-payload"></a>
</h4>
<p>The <code>&lt;component&gt;</code> part in the discovery topic must be one of the supported MQTT-platforms.
The options in the payload are only used to set up one specific component. If there are more components, more discovery payloads need to be sent for the other components, and it is then recommended to use <a href="https://www.home-assistant.io/integrations/mqtt/#device-discovery-payload">device-based discovery</a> instead.</p>
<p>Example discovery payload:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ids"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span>
    <span class="token property">"mf"</span><span class="token operator">:</span> <span class="token string">"Bla electronics"</span><span class="token punctuation">,</span>
    <span class="token property">"mdl"</span><span class="token operator">:</span> <span class="token string">"xya"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"sn"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1.0rev2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"bla2mqtt"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"<a class="token url-link" href="https://bla2mqtt.example.com/support">https://bla2mqtt.example.com/support</a>"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"temperature"</span><span class="token punctuation">,</span>
  <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"°C"</span><span class="token punctuation">,</span>
  <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.temperature}}"</span><span class="token punctuation">,</span>
  <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"temp01ae_t"</span><span class="token punctuation">,</span>
  <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"sensorBedroom/state"</span><span class="token punctuation">,</span>
  <span class="token property">"qos"</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>To remove the component, publish an empty string to the discovery topic. This will remove the component and clear the published discovery payload. It will also remove the device entry if there are no further references to it.</p>
<p>For more examples <a href="https://www.home-assistant.io/integrations/mqtt/#discovery-examples-with-component-discovery">see</a>.</p>
<h4>Discovery payload <a class="title-link" name="discovery-payload" href="https://www.home-assistant.io/integrations/mqtt/#discovery-payload"></a>
</h4>
<p>The payload must be a serialized JSON dictionary and will be checked like an entry in your <span class="terminology"><code>configuration.yaml</code><span class="terminology-tooltip">The configuration.yaml file is the main configuration file for Home Assistant. It lists the integrations to be loaded and their specific configurations. In some cases, the configuration needs to be edited manually directly in the configuration.yaml file. Most integrations can be configured in the UI.<a class="terminology-link" href="https://www.home-assistant.io/docs/configuration/"> [Learn more]</a></span></span> file if a new device is added, with the exception that unknown configuration keys are allowed but ignored. This means that missing variables will be filled with the integration’s default values. All configuration variables which are <em>required</em> must be present in the payload. The reason for allowing unknown documentation keys is allow some backwards compatibility, software generating MQTT discovery messages can then be used with older Home Assistant versions which will simply ignore new features.</p>
<p>A discovery payload can be sent with a retain flag set. In that case, the discovery message will be stored at the MQTT broker and processed automatically when the MQTT integrations start. This method removes the need for it to be resent. A better approach, though, is for the software generating MQTT discovery messages to send discovery payload(s) when the MQTT integration sends the <a href="https://www.home-assistant.io/integrations/mqtt/#birth-and-last-will-messages">Birth message</a>.</p>
<p>Subsequent messages on a topic where a valid payload has been received will be handled as a configuration update, and a configuration update with an empty payload will cause a previously discovered device to be deleted.</p>
<p>A base topic <code>~</code> may be defined in the payload to conserve memory when the same topic base is used multiple times.
In the value of configuration variables ending with <code>_topic</code>, <code>~</code> will be replaced with the base topic, if the <code>~</code> occurs at the beginning or end of the value.</p>
<p>Configuration variable names in the discovery payload may be abbreviated to conserve memory when sending a discovery message from memory constrained devices.</p>
<p>It is recommended to add information about the origin of MQTT entities by including the <code>origin</code> option (abbreviated as <code>o</code>) in the discovery payload. For device-based discovery, this information is required. The origin details will be logged in the core event log when an item is discovered or updated. Adding origin information helps with troubleshooting and provides valuable context about the source of MQTT messages in your Home Assistant setup.</p>
<p>Note: These options also support abbreviations, as shown in the table below.</p>
<div class="config-vars basic">
  <div class="">
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">name</span><a name="name" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#name"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The name of the application that is the origin of the discovered MQTT item. (Required)</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">sw_version</span><a name="sw_version" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#sw_version"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Software version of the application that supplies the discovered MQTT item.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name">support_url</span><a name="support_url" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#support_url"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Support URL of the application that supplies the discovered MQTT item.</p>
</span></div>
</div>
</div>
</div>
<h4>Supported abbreviations in MQTT discovery messages <a class="title-link" name="supported-abbreviations-in-mqtt-discovery-messages" href="https://www.home-assistant.io/integrations/mqtt/#supported-abbreviations-in-mqtt-discovery-messages"></a>
</h4>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span>Supported abbreviations</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_2">
<div class="language-txt highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-txt"><code data-lang="txt" class=" language-txt">'act_t':               'action_topic',
'act_tpl':             'action_template',
'atype':               'automation_type',
'aux_cmd_t':           'aux_command_topic',
'aux_stat_t':          'aux_state_topic',
'aux_stat_tpl':        'aux_state_template',
'av_tones':            'available_tones',
'avty':                'availability',
'avty_mode':           'availability_mode',
'avty_t':              'availability_topic',
'avty_tpl':            'availability_template',
'away_mode_cmd_t':     'away_mode_command_topic',
'away_mode_stat_t':    'away_mode_state_topic',
'away_mode_stat_tpl':  'away_mode_state_template',
'b_tpl':               'blue_template',
'bri_cmd_t':           'brightness_command_topic',
'bri_cmd_tpl':         'brightness_command_template',
'bri_scl':             'brightness_scale',
'bri_stat_t':          'brightness_state_topic',
'bri_tpl':             'brightness_template',
'bri_val_tpl':         'brightness_value_template',
'clr_temp_cmd_tpl':    'color_temp_command_template',
'clr_temp_cmd_t':      'color_temp_command_topic',
'clr_temp_k':           'color_temp_kelvin',
'clr_temp_stat_t':     'color_temp_state_topic',
'clr_temp_tpl':        'color_temp_template',
'clr_temp_val_tpl':    'color_temp_value_template',
'clrm':                'color_mode',
'clrm_stat_t':         'color_mode_state_topic',
'clrm_val_tpl':        'color_mode_value_template',
'cmd_off_tpl':         'command_off_template',
'cmd_on_tpl':          'command_on_template',
'cmd_t':               'command_topic',
'cmd_tpl':             'command_template',
'cmps':                'components',
'cod_arm_req':         'code_arm_required',
'cod_dis_req':         'code_disarm_required',
'cod_trig_req':        'code_trigger_required',
'cont_type':           'content_type',
'curr_temp_t':         'current_temperature_topic',
'curr_temp_tpl':       'current_temperature_template',
'dev':                 'device',
'dev_cla':             'device_class',
'dir_cmd_t':           'direction_command_topic',
'dir_cmd_tpl':         'direction_command_template',
'dir_stat_t':          'direction_state_topic',
'dir_val_tpl':         'direction_value_template',
'dsp_prc':             'display_precision',
'e':                   'encoding',
'en':                  'enabled_by_default',
'ent_cat':             'entity_category',
'ent_pic':             'entity_picture',
'evt_typ':             'event_types',
'exp_aft':             'expire_after',
'fanspd_lst':          'fan_speed_list',
'flsh_tlng':           'flash_time_long',
'flsh_tsht':           'flash_time_short',
'fx_cmd_t':            'effect_command_topic',
'fx_cmd_tpl':          'effect_command_template',
'fx_list':             'effect_list',
'fx_stat_t':           'effect_state_topic',
'fx_tpl':              'effect_template',
'fx_val_tpl':          'effect_value_template',
'fan_mode_cmd_t':      'fan_mode_command_topic',
'fan_mode_cmd_tpl':    'fan_mode_command_template',
'fan_mode_stat_t':     'fan_mode_state_topic',
'fan_mode_stat_tpl':   'fan_mode_state_template',
'frc_upd':             'force_update',
'g_tpl':               'green_template',
'hs_cmd_t':            'hs_command_topic',
'hs_cmd_tpl':          'hs_command_template',
'hs_stat_t':           'hs_state_topic',
'hs_val_tpl':          'hs_value_template',
'ic':                  'icon',
'img_e':               'image_encoding',
'img_t':               'image_topic',
'init':                'initial',
'hum_cmd_t':           'target_humidity_command_topic',
'hum_cmd_tpl':         'target_humidity_command_template',
'hum_stat_t':          'target_humidity_state_topic',
'hum_state_tpl':       'target_humidity_state_template',
'json_attr':           'json_attributes',
'json_attr_t':         'json_attributes_topic',
'json_attr_tpl':       'json_attributes_template',
'l_ver_t':             'latest_version_topic',
'l_ver_tpl':           'latest_version_template',
'lrst_t':              'last_reset_topic',
'lrst_val_tpl':        'last_reset_value_template',
'max':                 'max',
'max_hum':             'max_humidity',
'max_k':               'max_kelvin',
'max_mirs':            'max_mireds',
'max_temp':            'max_temp',
'migr_discvry':        'migrate_discovery',
'min':                 'min',
'min_hum':             'min_humidity',
'min_k':               'min_kelvin',
'min_mirs':            'min_mireds',
'min_temp':            'min_temp',
'mode':                'mode',
'mode_cmd_t':          'mode_command_topic',
'mode_cmd_tpl':        'mode_command_template',
'mode_stat_t':         'mode_state_topic',
'mode_stat_tpl':       'mode_state_template',
'modes':               'modes',
'name':                'name',
'o':                   'origin',
'obj_id':              'object_id',
'off_dly':             'off_delay',
'on_cmd_type':         'on_command_type',
'ops':                 'options',
'opt':                 'optimistic',
'osc_cmd_t':           'oscillation_command_topic',
'osc_cmd_tpl':         'oscillation_command_template',
'osc_stat_t':          'oscillation_state_topic',
'osc_val_tpl':         'oscillation_value_template',
'p':                   'platform',
'pct_cmd_t':           'percentage_command_topic',
'pct_cmd_tpl':         'percentage_command_template',
'pct_stat_t':          'percentage_state_topic',
'pct_val_tpl':         'percentage_value_template',
'pl':                  'payload',
'pl_arm_away':         'payload_arm_away',
'pl_arm_custom_b':     'payload_arm_custom_bypass',
'pl_arm_home':         'payload_arm_home',
'pl_arm_nite':         'payload_arm_night',
'pl_arm_vacation':     'payload_arm_vacation',
'pl_avail':            'payload_available',
'pl_cln_sp':           'payload_clean_spot',
'pl_cls':              'payload_close',
'pl_dir_fwd':          'payload_direction_forward',
'pl_dir_rev':          'payload_direction_reverse',
'pl_disarm':           'payload_disarm',
'pl_home':             'payload_home',
'pl_inst':             'payload_install',
'pl_loc':              'payload_locate',
'pl_lock':             'payload_lock',
'pl_not_avail':        'payload_not_available',
'pl_not_home':         'payload_not_home',
'pl_off':              'payload_off',
'pl_on':               'payload_on',
'pl_open':             'payload_open',
'pl_osc_off':          'payload_oscillation_off',
'pl_osc_on':           'payload_oscillation_on',
'pl_paus':             'payload_pause',
'pl_stop':             'payload_stop',
'pl_strt':             'payload_start',
'pl_prs':              'payload_press',
'pl_ret':              'payload_return_to_base',
'pl_rst':              'payload_reset',
'pl_rst_hum':          'payload_reset_humidity',
'pl_rst_mode':         'payload_reset_mode',
'pl_rst_pct':          'payload_reset_percentage',
'pl_rst_pr_mode':      'payload_reset_preset_mode',
'pl_stop':             'payload_stop',
'pl_stpa':             'payload_start_pause',
'pl_strt':             'payload_start',
'pl_toff':             'payload_turn_off',
'pl_ton':              'payload_turn_on',
'pl_trig':             'payload_trigger',
'pl_unlk':             'payload_unlock',
'pos':                 'reports_position',
'pos_clsd':            'position_closed',
'pos_open':            'position_open',
'pr_mode_cmd_t':       'preset_mode_command_topic',
'pr_mode_cmd_tpl':     'preset_mode_command_template',
'pr_mode_stat_t':      'preset_mode_state_topic',
'pr_mode_val_tpl':     'preset_mode_value_template',
'pr_modes':            'preset_modes',
'ptrn':                'pattern',
'r_tpl':               'red_template',
'rel_s':               'release_summary',
'rel_u':               'release_url',
'ret':                 'retain',
'rgb_cmd_t':           'rgb_command_topic',
'rgb_cmd_tpl':         'rgb_command_template',
'rgb_stat_t':          'rgb_state_topic',
'rgb_val_tpl':         'rgb_value_template',
'rgbw_cmd_t':          'rgbw_command_topic',
'rgbw_cmd_tpl':        'rgbw_command_template',
'rgbw_stat_t':         'rgbw_state_topic',
'rgbw_val_tpl':        'rgbw_value_template',
'rgbww_cmd_t':         'rgbww_command_topic',
'rgbww_cmd_tpl':       'rgbww_command_template',
'rgbww_stat_t':        'rgbww_state_topic',
'rgbww_val_tpl':       'rgbww_value_template',
'send_cmd_t':          'send_command_topic',
'send_if_off':         'send_if_off',
'set_fan_spd_t':       'set_fan_speed_topic',
'set_pos_t':           'set_position_topic',
'set_pos_tpl':         'set_position_template',
'pos_t':               'position_topic',
'pos_tpl':             'position_template',
'spd_rng_min':         'speed_range_min',
'spd_rng_max':         'speed_range_max',
'src_type':            'source_type',
'stat_cla':            'state_class',
'stat_closing':        'state_closing',
'stat_clsd':           'state_closed',
'stat_jam':            'state_jammed',
'stat_locked':         'state_locked',
'stat_locking':        'state_locking',
'stat_off':            'state_off',
'stat_on':             'state_on',
'stat_open':           'state_open',
'stat_opening':        'state_opening',
'stat_stopped':        'state_stopped',
'stat_unlocked':       'state_unlocked',
'stat_unlocking':      'state_unlocking',
'stat_t':              'state_topic',
'stat_tpl':            'state_template',
'stat_val_tpl':        'state_value_template',
'step':                'step',
'stype':               'subtype',
'sug_dsp_prc':         'suggested_display_precision',
'sup_clrm':            'supported_color_modes',
'sup_dur':             'support_duration',
'sup_vol':             'support_volume_set',
'sup_feat':            'supported_features',
'swing_mode_cmd_t':    'swing_mode_command_topic',
'swing_mode_cmd_tpl':  'swing_mode_command_template',
'swing_mode_stat_t':   'swing_mode_state_topic',
'swing_mode_stat_tpl': 'swing_mode_state_template',
't':                   'topic',
'temp_cmd_t':          'temperature_command_topic',
'temp_cmd_tpl':        'temperature_command_template',
'temp_hi_cmd_t':       'temperature_high_command_topic',
'temp_hi_cmd_tpl':     'temperature_high_command_template',
'temp_hi_stat_t':      'temperature_high_state_topic',
'temp_hi_stat_tpl':    'temperature_high_state_template',
'temp_lo_cmd_t':       'temperature_low_command_topic',
'temp_lo_cmd_tpl':     'temperature_low_command_template',
'temp_lo_stat_t':      'temperature_low_state_topic',
'temp_lo_stat_tpl':    'temperature_low_state_template',
'temp_stat_t':         'temperature_state_topic',
'temp_stat_tpl':       'temperature_state_template',
'temp_unit':           'temperature_unit',
'tilt_clsd_val':       'tilt_closed_value',
'tilt_cmd_t':          'tilt_command_topic',
'tilt_cmd_tpl':        'tilt_command_template',
'tilt_max':            'tilt_max',
'tilt_min':            'tilt_min',
'tilt_opnd_val':       'tilt_opened_value',
'tilt_opt':            'tilt_optimistic',
'tilt_status_t':       'tilt_status_topic',
'tilt_status_tpl':     'tilt_status_template',
'tit':                 'title',
'uniq_id':             'unique_id',
'unit_of_meas':        'unit_of_measurement',
'url_t':               'url_topic',
'url_tpl':             'url_template',
'val_tpl':             'value_template',
'whit_cmd_t':          'white_command_topic',
'whit_scl':            'white_scale',
'xy_cmd_t':            'xy_command_topic',
'xy_cmd_tpl':          'xy_command_template',
'xy_stat_t':           'xy_state_topic',
'xy_val_tpl':          'xy_value_template',</code></pre><div class="toolbar"><div class="toolbar-item"><span>Txt</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
</div>
  </details>
</div>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span>Supported abbreviations for device registry configuration</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_3">
<div class="language-txt highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-txt"><code data-lang="txt" class=" language-txt">'cu':                  'configuration_url',
'cns':                 'connections',
'ids':                 'identifiers',
'name':                'name',
'mf':                  'manufacturer',
'mdl':                 'model',
'mdl_id':              'model_id',
'hw':                  'hw_version',
'sw':                  'sw_version',
'sa':                  'suggested_area',
'sn':                  'serial_number',</code></pre><div class="toolbar"><div class="toolbar-item"><span>Txt</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
</div>
  </details>
</div>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span>Supported abbreviations for origin info</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_4">
<div class="language-txt highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-txt"><code data-lang="txt" class=" language-txt">'name':                'name',
'sw':                  'sw_version',
'url':                 'support_url',</code></pre><div class="toolbar"><div class="toolbar-item"><span>Txt</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
</div>
  </details>
</div>
<h3>Discovery messages and availability <a class="title-link" name="discovery-messages-and-availability" href="https://www.home-assistant.io/integrations/mqtt/#discovery-messages-and-availability"></a>
</h3>
<p>When MQTT discovery is set up, and a device or service sends a discovery message,
an MQTT entity, tag, or device automation will be set up directly after receiving the message.
When Home Assistant is restarting, discovered MQTT items with a unique ID will be unavailable until a new
discovery message is received. MQTT items without a unique ID will not be added at startup.
So a device or service using MQTT discovery must make sure a configuration message is offered
after the <strong>MQTT</strong> integration has been (re)started. There are 2 common approaches to make sure the
discovered items are set up at startup:</p>
<ol>
<li>Using Birth and Will messages to trigger setup</li>
<li>Using retained messages</li>
</ol>
<p>Finally, it is a best practice to publish your device or service availability status.</p>
<h4>Use the Birth and Will messages to trigger discovery <a class="title-link" name="use-the-birth-and-will-messages-to-trigger-discovery" href="https://www.home-assistant.io/integrations/mqtt/#use-the-birth-and-will-messages-to-trigger-discovery"></a>
</h4>
<p>When the <strong>MQTT</strong> integration starts, a birth message is published at <code>homeassistant/status</code> by default.
A device or service connected to the shared <code>mqtt</code> broker can subscribe to this topic and use an <code>online</code> message
to trigger discovery messages. See also the <a href="https://www.home-assistant.io/integrations/mqtt/#birth-and-last-will-messages">birth and last will messages</a>
section. After the configs have been published, the state topics will need an update, so they need to be republished.</p>
<h4>Using retained config messages <a class="title-link" name="using-retained-config-messages" href="https://www.home-assistant.io/integrations/mqtt/#using-retained-config-messages"></a>
</h4>
<p>An alternative method for a device or service is to publish discovery messages with a <code>retain</code> flag. This will make sure
discovery messages are replayed when the <strong>MQTT</strong> integration connects to the broker.
After the configs have been published, the state topics will need an update.</p>
<h4>Using retained state messages <a class="title-link" name="using-retained-state-messages" href="https://www.home-assistant.io/integrations/mqtt/#using-retained-state-messages"></a>
</h4>
<p>State updates also need to be re-published after a config as been processed.
This can also be done by publishing <code>retained</code> messages. As soon as a config is received (or replayed from a retained message),
the setup will subscribe any state topics. If a retained message is available at a state topic,
this message will be replayed so that the state can be restored for this topic.</p>
<div class="alert alert-warning">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:alert-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Warning</p>
  <p class="alert-content">
</p>
<p>A disadvantage of using retained messages is that these messages retain at the broker,
even when the device or service stops working. They are retained even after the system or broker has been restarted.
Retained messages can create ghost entities that keep coming back.
<br><br>
Especially when you have many entities, (unneeded) discovery messages can cause excessive system load. For this reason, use discovery messages with caution.</p>
  
</div>
<h3>Using Availability topics <a class="title-link" name="using-availability-topics" href="https://www.home-assistant.io/integrations/mqtt/#using-availability-topics"></a>
</h3>
<p>A device or service can announce its availability by publishing a Birth message and set a Will message at the broker.
When the device or service loses connection to the broker, the broker will publish the Will message.
This allows the <strong>MQTT</strong> integration to make an entity unavailable.</p>
<p>Platform specific availability settings are available for <code>mqtt</code> entity platforms only.</p>
<div class="details-block">
  <details class="details-block-item">
    <summary class="details-block-title">
      <span>Platform specific availability settings</span>
      <div class="details-block-arrow">
      <svg class="down" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>
      <svg class="up" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"></path></svg>
      </div>
    </summary>
    <div class="details-block-content" id="content_5">
<div class="config-vars">
  <h4>
    Configuration Variables <a class="title-link" name="configuration-variables" href="https://www.home-assistant.io/integrations/mqtt/#configuration-variables"></a>
  </h4>
  <div class="configuration-link">
    <a href="https://www.home-assistant.io/docs/configuration/" target="_blank">Looking for your configuration file?</a>
  </div>
  <div class="">
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> availability </span><span class="config-vars-type">list</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="availability" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#availability"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>A list of MQTT topics subscribed to receive availability (online/offline) updates. Must not be used together with <code>availability_topic</code>.</p>
</span></div>
<div class="nested">
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> payload_available </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: online</span>)</span><a name="payload_available" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#payload_available"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The payload that represents the available state.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> payload_not_available </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: offline</span>)</span><a name="payload_not_available" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#payload_not_available"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The payload that represents the unavailable state.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> topic </span><span class="config-vars-type">string</span><span class="config-vars-required"> <span class="true">Required</span><span class="default"></span></span><a name="topic" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#topic"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>An MQTT topic subscribed to receive availability (online/offline) updates.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> value_template </span><span class="config-vars-type"><a href="https://www.home-assistant.io/docs/configuration/templating/">template</a></span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="value_template" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#value_template"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Defines a <a href="https://www.home-assistant.io/docs/configuration/templating/#using-templates-with-the-mqtt-integration">template</a> to extract a device’s availability from the <code>topic</code>. To determine the device’s availability, the result of this template will be compared to <code>payload_available</code> and <code>payload_not_available</code>.</p>
</span></div>
</div>
</div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> availability_topic </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="availability_topic" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#availability_topic"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The MQTT topic subscribed to receive availability (online/offline) updates. Must not be used together with <code>availability</code>.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> availability_mode </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: latest</span>)</span><a name="availability_mode" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#availability_mode"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>When <code>availability</code> is configured, this controls the conditions needed to set the entity to <code>available</code>. Valid entries are <code>all</code>, <code>any</code>, and <code>latest</code>. If set to <code>all</code>, <code>payload_available</code> must be received on all configured availability topics before the entity is marked as online. If set to <code>any</code>, <code>payload_available</code> must be received on at least one configured availability topic before the entity is marked as online. If set to <code>latest</code>, the last <code>payload_available</code> or <code>payload_not_available</code> received on any configured availability topic controls the availability.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> availability_template </span><span class="config-vars-type"><a href="https://www.home-assistant.io/docs/configuration/templating/">template</a></span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default"></span>)</span><a name="availability_template" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#availability_template"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>Defines a <a href="https://www.home-assistant.io/docs/configuration/templating/#using-templates-with-the-mqtt-integration">template</a> to extract device’s availability from the <code>availability_topic</code>. To determine the devices’s availability result of this template will be compared to <code>payload_available</code> and <code>payload_not_available</code>.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> payload_available </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: online</span>)</span><a name="payload_available" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#payload_available"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The payload that represents the available state.</p>
</span></div>
</div>
<div class="config-vars-item">
<div class="config-vars-label">
<span class="config-vars-label-name"> payload_not_available </span><span class="config-vars-type">string</span><span class="config-vars-required"> (<span class="false">Optional</span><span class="default">, default: offline</span>)</span><a name="payload_not_available" class="title-link" href="https://www.home-assistant.io/integrations/mqtt/#payload_not_available"></a>
</div>
<div class="config-vars-description-and-children"><span class="config-vars-description"><p>The payload that represents the unavailable state.</p>
</span></div>
</div>
</div>
</div>
</div>
  </details>
</div>
<h3>Discovery examples with component discovery <a class="title-link" name="discovery-examples-with-component-discovery" href="https://www.home-assistant.io/integrations/mqtt/#discovery-examples-with-component-discovery"></a>
</h3>
<h4>Motion detection (binary sensor) <a class="title-link" name="motion-detection-binary-sensor" href="https://www.home-assistant.io/integrations/mqtt/#motion-detection-binary-sensor"></a>
</h4>
<p>A motion detection device which can be represented by a <a href="https://www.home-assistant.io/integrations/binary_sensor.mqtt/">binary sensor</a> for your garden would send its configuration as JSON payload to the Configuration topic. After the first message to <code>config</code>, then the MQTT messages sent to the state topic will update the state in Home Assistant.</p>
<ul>
<li>Configuration topic: <code>homeassistant/binary_sensor/garden/config</code>
</li>
<li>State topic: <code>homeassistant/binary_sensor/garden/state</code>
</li>
<li>Configuration payload with derived device name:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"name"</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
   <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"motion"</span><span class="token punctuation">,</span>
   <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"homeassistant/binary_sensor/garden/state"</span><span class="token punctuation">,</span>
   <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"motion01ad"</span><span class="token punctuation">,</span>
   <span class="token property">"device"</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">"identifiers"</span><span class="token operator">:</span><span class="token punctuation">[</span>
         <span class="token string">"01ad"</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"Garden"</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<ul>
<li>Retain: The -r switch is added to retain the configuration topic in the broker. Without this, the sensor will not be available after Home Assistant restarts.</li>
</ul>
<p>It is also a good idea to add a <code>unique_id</code> to allow changes to the entity and a <code>device</code> mapping so we can group all sensors of a device together. We can set “name” to <code>null</code> if we want to inherit the device name for the entity. If we set an entity name, the <code>friendly_name</code> will be a combination of the device and entity name. If <code>name</code> is left away and a <code>device_class</code> is set, the entity name part will be derived from the <code>device_class</code>.</p>
<ul>
<li>Example configuration payload with no name set and derived <code>device_class</code> name:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"name"</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
   <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"motion"</span><span class="token punctuation">,</span>
   <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"homeassistant/binary_sensor/garden/state"</span><span class="token punctuation">,</span>
   <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"motion01ad"</span><span class="token punctuation">,</span>
   <span class="token property">"device"</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">"identifiers"</span><span class="token operator">:</span><span class="token punctuation">[</span>
         <span class="token string">"01ad"</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"Garden"</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>If no name is set, a default name will be set by MQTT (<a href="https://www.home-assistant.io/integrations/mqtt/#mqtt-discovery">see the MQTT platform documentation</a>).</p>
<p>To create a new sensor manually and with the name set to <code>null</code> to derive the device name “Garden”:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_pub -r -h <span class="token number">127.0</span>.0.1 -p <span class="token number">1883</span> -t <span class="token string">"homeassistant/binary_sensor/garden/config"</span> -m <span class="token string">'{"name": null, "device_class": "motion", "state_topic": "homeassistant/binary_sensor/garden/state", "unique_id": "motion01ad", "device": {"identifiers": ["01ad"], "name": "Garden" }}'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Update the state:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_pub -h <span class="token number">127.0</span>.0.1 -p <span class="token number">1883</span> -t <span class="token string">"homeassistant/binary_sensor/garden/state"</span> -m ON</code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Delete the sensor by sending an empty message.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_pub -h <span class="token number">127.0</span>.0.1 -p <span class="token number">1883</span> -t <span class="token string">"homeassistant/binary_sensor/garden/config"</span> -m <span class="token string">''</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>For more details please refer to the <a href="https://www.home-assistant.io/integrations/mqtt/#testing-your-setup">MQTT testing section</a>.</p>
<h4>Sensors <a class="title-link" name="sensors" href="https://www.home-assistant.io/integrations/mqtt/#sensors"></a>
</h4>
<p>Setting up a sensor with multiple measurement values requires multiple consecutive configuration topic submissions.</p>
<ul>
<li>Configuration topic no1: <code>homeassistant/sensor/sensorBedroomT/config</code>
</li>
<li>Configuration payload no1:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"temperature"</span><span class="token punctuation">,</span>
   <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"homeassistant/sensor/sensorBedroom/state"</span><span class="token punctuation">,</span>
   <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"°C"</span><span class="token punctuation">,</span>
   <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.temperature}}"</span><span class="token punctuation">,</span>
   <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"temp01ae"</span><span class="token punctuation">,</span>
   <span class="token property">"device"</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">"identifiers"</span><span class="token operator">:</span><span class="token punctuation">[</span>
          <span class="token string">"bedroom01ae"</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"Bedroom"</span><span class="token punctuation">,</span>
      <span class="token property">"manufacturer"</span><span class="token operator">:</span> <span class="token string">"Example sensors Ltd."</span><span class="token punctuation">,</span>
      <span class="token property">"model"</span><span class="token operator">:</span> <span class="token string">"Example Sensor"</span><span class="token punctuation">,</span>
      <span class="token property">"model_id"</span><span class="token operator">:</span> <span class="token string">"K9"</span><span class="token punctuation">,</span>
      <span class="token property">"serial_number"</span><span class="token operator">:</span> <span class="token string">"12AE3010545"</span><span class="token punctuation">,</span>
      <span class="token property">"hw_version"</span><span class="token operator">:</span> <span class="token string">"1.01a"</span><span class="token punctuation">,</span>
      <span class="token property">"sw_version"</span><span class="token operator">:</span> <span class="token string">"2024.1.0"</span><span class="token punctuation">,</span>
      <span class="token property">"configuration_url"</span><span class="token operator">:</span> <span class="token string">"<a class="token url-link" href="https://example.com/sensor_portal/config">https://example.com/sensor_portal/config</a>"</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<ul>
<li>Configuration topic no2: <code>homeassistant/sensor/sensorBedroomH/config</code>
</li>
<li>Configuration payload no2:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"device_class"</span><span class="token operator">:</span><span class="token string">"humidity"</span><span class="token punctuation">,</span>
   <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"homeassistant/sensor/sensorBedroom/state"</span><span class="token punctuation">,</span>
   <span class="token property">"unit_of_measurement"</span><span class="token operator">:</span><span class="token string">"%"</span><span class="token punctuation">,</span>
   <span class="token property">"value_template"</span><span class="token operator">:</span><span class="token string">"{{ value_json.humidity}}"</span><span class="token punctuation">,</span>
   <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"hum01ae"</span><span class="token punctuation">,</span>
   <span class="token property">"device"</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">"identifiers"</span><span class="token operator">:</span><span class="token punctuation">[</span>
         <span class="token string">"bedroom01ae"</span>
      <span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>The sensor <a href="https://www.home-assistant.io/integrations/sensor.mqtt/#device"><code>identifiers</code> or <code>connections</code></a> option allows to set up multiple entities that share the same device.</p>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:information-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Note</p>
  <p class="alert-content">
</p>
<p>If a device configuration is shared, then it is not needed to add all device details to the other entity configs. It is enough to add shared identifiers or connections to the device mapping for the other entity config payloads.</p>
  
</div>
<p>A common state payload that can be parsed with the <code>value_template</code> in the sensor configs:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"temperature"</span><span class="token operator">:</span><span class="token number">23.20</span><span class="token punctuation">,</span>
   <span class="token property">"humidity"</span><span class="token operator">:</span><span class="token number">43.70</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h4>Entities with command topics <a class="title-link" name="entities-with-command-topics" href="https://www.home-assistant.io/integrations/mqtt/#entities-with-command-topics"></a>
</h4>
<p>Setting up a light, switch etc. is similar but requires a <code>command_topic</code> as mentioned in the <a href="https://www.home-assistant.io/integrations/switch.mqtt/">MQTT switch documentation</a>.</p>
<ul>
<li>Configuration topic: <code>homeassistant/switch/irrigation/config</code>
</li>
<li>State topic: <code>homeassistant/switch/irrigation/state</code>
</li>
<li>Command topic: <code>homeassistant/switch/irrigation/set</code>
</li>
<li>Payload:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"Irrigation"</span><span class="token punctuation">,</span>
   <span class="token property">"command_topic"</span><span class="token operator">:</span><span class="token string">"homeassistant/switch/irrigation/set"</span><span class="token punctuation">,</span>
   <span class="token property">"state_topic"</span><span class="token operator">:</span><span class="token string">"homeassistant/switch/irrigation/state"</span><span class="token punctuation">,</span>
   <span class="token property">"unique_id"</span><span class="token operator">:</span><span class="token string">"irr01ad"</span><span class="token punctuation">,</span>
   <span class="token property">"device"</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">"identifiers"</span><span class="token operator">:</span><span class="token punctuation">[</span>
         <span class="token string">"garden01ad"</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"Garden"</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<ul>
<li>Retain: The -r switch is added to retain the configuration topic in the broker. Without this, the sensor will not be available after Home Assistant restarts.</li>
</ul>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_pub -r -h <span class="token number">127.0</span>.0.1 -p <span class="token number">1883</span> -t <span class="token string">"homeassistant/switch/irrigation/config"</span> <span class="token punctuation">\</span>
  -m <span class="token string">'{"name": "Irrigation", "command_topic": "homeassistant/switch/irrigation/set", "state_topic": "homeassistant/switch/irrigation/state", "unique_id": "irr01ad", "device": {"identifiers": ["garden01ad"], "name": "Garden" }}'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Set the state:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">mosquitto_pub -h <span class="token number">127.0</span>.0.1 -p <span class="token number">1883</span> -t <span class="token string">"homeassistant/switch/irrigation/set"</span> -m ON</code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h4>Using abbreviations and base topic <a class="title-link" name="using-abbreviations-and-base-topic" href="https://www.home-assistant.io/integrations/mqtt/#using-abbreviations-and-base-topic"></a>
</h4>
<p>Setting up a switch using topic prefix and abbreviated configuration variable names to reduce payload length.</p>
<ul>
<li>Configuration topic: <code>homeassistant/switch/irrigation/config</code>
</li>
<li>Command topic: <code>homeassistant/switch/irrigation/set</code>
</li>
<li>State topic: <code>homeassistant/switch/irrigation/state</code>
</li>
<li>Configuration payload:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
   <span class="token property">"~"</span><span class="token operator">:</span><span class="token string">"homeassistant/switch/irrigation"</span><span class="token punctuation">,</span>
   <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"garden"</span><span class="token punctuation">,</span>
   <span class="token property">"cmd_t"</span><span class="token operator">:</span><span class="token string">"~/set"</span><span class="token punctuation">,</span>
   <span class="token property">"stat_t"</span><span class="token operator">:</span><span class="token string">"~/state"</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h4>Another example using abbreviations topic name and base topic <a class="title-link" name="another-example-using-abbreviations-topic-name-and-base-topic" href="https://www.home-assistant.io/integrations/mqtt/#another-example-using-abbreviations-topic-name-and-base-topic"></a>
</h4>
<p>Setting up a <a href="https://www.home-assistant.io/integrations/light.mqtt/#json-schema">light that takes JSON payloads</a>, with abbreviated configuration variable names:</p>
<ul>
<li>
<p>Configuration topic: <code>homeassistant/light/kitchen/config</code></p>
</li>
<li>
<p>Command topic: <code>homeassistant/light/kitchen/set</code></p>
</li>
<li>
<p>State topic: <code>homeassistant/light/kitchen/state</code></p>
</li>
<li>
<p>Example state payload: <code>{"state": "ON", "brightness": 255}</code></p>
</li>
<li>
<p>Configuration payload:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"~"</span><span class="token operator">:</span> <span class="token string">"homeassistant/light/kitchen"</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span>
  <span class="token property">"uniq_id"</span><span class="token operator">:</span> <span class="token string">"kitchen_light"</span><span class="token punctuation">,</span>
  <span class="token property">"cmd_t"</span><span class="token operator">:</span> <span class="token string">"~/set"</span><span class="token punctuation">,</span>
  <span class="token property">"stat_t"</span><span class="token operator">:</span> <span class="token string">"~/state"</span><span class="token punctuation">,</span>
  <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
  <span class="token property">"brightness"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
</li>
</ul>
<h4>Example with using abbreviated Device and Origin info in discovery messages <a class="title-link" name="example-with-using-abbreviated-device-and-origin-info-in-discovery-messages" href="https://www.home-assistant.io/integrations/mqtt/#example-with-using-abbreviated-device-and-origin-info-in-discovery-messages"></a>
</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"~"</span><span class="token operator">:</span> <span class="token string">"homeassistant/light/kitchen"</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">"uniq_id"</span><span class="token operator">:</span> <span class="token string">"kitchen_light"</span><span class="token punctuation">,</span>
  <span class="token property">"cmd_t"</span><span class="token operator">:</span> <span class="token string">"~/set"</span><span class="token punctuation">,</span>
  <span class="token property">"stat_t"</span><span class="token operator">:</span> <span class="token string">"~/state"</span><span class="token punctuation">,</span>
  <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ids"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span>
    <span class="token property">"mf"</span><span class="token operator">:</span> <span class="token string">"Bla electronics"</span><span class="token punctuation">,</span>
    <span class="token property">"mdl"</span><span class="token operator">:</span> <span class="token string">"xya"</span><span class="token punctuation">,</span>
    <span class="token property">"mdl_id"</span><span class="token operator">:</span> <span class="token string">"ABC123"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"sn"</span><span class="token operator">:</span> <span class="token string">"ea334450945afc"</span><span class="token punctuation">,</span>
    <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1.0rev2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"bla2mqtt"</span><span class="token punctuation">,</span>
    <span class="token property">"sw"</span><span class="token operator">:</span> <span class="token string">"2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"<a class="token url-link" href="https://bla2mqtt.example.com/support">https://bla2mqtt.example.com/support</a>"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h4>Use object_id to influence the entity id <a class="title-link" name="use-object_id-to-influence-the-entity-id" href="https://www.home-assistant.io/integrations/mqtt/#use-object_id-to-influence-the-entity-id"></a>
</h4>
<p>The entity id is automatically generated from the entity’s name. All MQTT integrations optionally support providing an <code>object_id</code> which will be used instead if provided.</p>
<ul>
<li>Configuration topic: <code>homeassistant/sensor/device1/config</code>
</li>
<li>Example configuration payload:</li>
</ul>
<div class="language-json highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-json"><code data-lang="json" class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"My Super Device"</span><span class="token punctuation">,</span>
  <span class="token property">"object_id"</span><span class="token operator">:</span><span class="token string">"my_super_device"</span><span class="token punctuation">,</span>
  <span class="token property">"state_topic"</span><span class="token operator">:</span> <span class="token string">"homeassistant/sensor/device1/state"</span>
 <span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JSON</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>In the example above, the entity_id will be <code>sensor.my_super_device</code> instead of <code>sensor.device1</code>.</p>
<h3>Support by third-party tools <a class="title-link" name="support-by-third-party-tools" href="https://www.home-assistant.io/integrations/mqtt/#support-by-third-party-tools"></a>
</h3>
<p>The following software has built-in support for MQTT discovery:</p>
<ul>
<li><a href="https://github.com/dawidchyrzynski/arduino-home-assistant" rel="external nofollow">ArduinoHA<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/smrtnt/Arilux_AL-LC0X" rel="external nofollow">Arilux AL-LC0X LED controllers<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/devbis/ble2mqtt" rel="external nofollow">ble2mqtt<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/IgnacioHR/diematic_server" rel="external nofollow">diematic_server<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/gaetancollaud/digitalstrom-mqtt" rel="external nofollow">digitalstrom-mqtt<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/john30/ebusd" rel="external nofollow">ebusd<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/bachya/ecowitt2mqtt" rel="external nofollow">ecowitt2mqtt<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/emsesp/EMS-ESP32" rel="external nofollow">EMS-ESP32 (and EMS-ESP)<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://esphome.io/">ESPHome<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/xoseperez/espurna" rel="external nofollow">ESPurna<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/koestler/go-iotdevice" rel="external nofollow">go-iotdevice<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/LAB02-Research/HASS.Agent" rel="external nofollow">HASS.Agent<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li>
<a href="https://iotlink.gitlab.io/" rel="external nofollow">IOTLink<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> (starting with 2.0.0)</li>
<li><a href="https://github.com/ThomDietrich/miflora-mqtt-daemon" rel="external nofollow">MiFlora MQTT Daemon<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/MyElectricalData/myelectricaldata_import#english" rel="external nofollow">MyElectricalData<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/MichelFR/MqDockerUp" rel="external nofollow">MqDockerUp<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/technyon/nuki_hub" rel="external nofollow">Nuki Hub<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li>
<a href="https://support.nuki.io/hc/articles/12947926779409-MQTT-support" rel="external nofollow">Nuki Smart Lock 3.0 Pro<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a>, <a href="https://developer.nuki.io/t/mqtt-api-specification-v1-3/17626" rel="external nofollow">more info<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a>
</li>
<li><a href="https://github.com/1technophile/OpenMQTTGateway" rel="external nofollow">OpenMQTTGateway<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/Laxilef/OTGateway" rel="external nofollow">OTGateway<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li>
<a href="https://github.com/mKeRix/room-assistant" rel="external nofollow">room-assistant<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> (starting with 1.1.0)</li>
<li><a href="https://github.com/roncoa/SmartHome" rel="external nofollow">SmartHome<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/adorobis/speedtest-CLI2mqtt" rel="external nofollow">SpeedTest-CLI MQTT<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/devWaves/SwitchBot-MQTT-BLE-ESP32" rel="external nofollow">SwitchBot-MQTT-BLE-ESP32<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li>
<a href="https://github.com/arendst/Tasmota" rel="external nofollow">Tasmota<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> (starting with 5.11.1e, development halted)</li>
<li><a href="https://github.com/toniebox-reverse-engineering/teddycloud" rel="external nofollow">TeddyCloud<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li>
<a href="https://fmartinou.github.io/teleinfo2mqtt" rel="external nofollow">Teleinfo MQTT<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> (starting with 3.0.0)</li>
<li><a href="https://fmartinou.github.io/tydom2mqtt/" rel="external nofollow">Tydom2MQTT<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li>
<a href="https://fmartinou.github.io/whats-up-docker/" rel="external nofollow">What’s up Docker?<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a> (starting with 3.5.0)</li>
<li><a href="https://github.com/raetha/wyzesense2mqtt" rel="external nofollow">WyzeSense2MQTT<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/EliasKotlyar/Xiaomi-Dafang-Hacks" rel="external nofollow">Xiaomi DaFang Hacks<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/adorobis/hacomfoairmqtt" rel="external nofollow">Zehnder Comfoair RS232 MQTT<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://github.com/koenkk/zigbee2mqtt" rel="external nofollow">Zigbee2MQTT<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
</ul>
<p>The following software also supports consuming MQTT discovery information that is intended for Home Assistant.
Compatibility and features will vary, and not all devices may work.</p>
<ul>
<li><a href="https://wiki.domoticz.com/MQTT#Add_hardware_.22MQTT_Auto_Discovery_Client_Gateway.22" rel="external nofollow">Domoticz<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
<li><a href="https://www.openhab.org/addons/bindings/mqtt.homeassistant/" rel="external nofollow">openHAB<iconify-icon inline="true" icon="tabler:external-link" class="external-link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
</ul>
<h2>Manual configured MQTT items <a class="title-link" name="manual-configured-mqtt-items" href="https://www.home-assistant.io/integrations/mqtt/#manual-configured-mqtt-items"></a>
</h2>
<p>For most integrations, it is also possible to manually set up MQTT items in <span class="terminology"><code>configuration.yaml</code><span class="terminology-tooltip">The configuration.yaml file is the main configuration file for Home Assistant. It lists the integrations to be loaded and their specific configurations. In some cases, the configuration needs to be edited manually directly in the configuration.yaml file. Most integrations can be configured in the UI.<a class="terminology-link" href="https://www.home-assistant.io/docs/configuration/"> [Learn more]</a></span></span>. Read more <a href="https://www.home-assistant.io/docs/configuration/yaml">about configuration in YAML</a>.</p>
<p>MQTT supports two styles for configuring items in YAML. All configuration items are placed directly under the <code>mqtt</code> integration key. Note that you cannot mix these styles. Use the <em>YAML configuration listed per item</em> style when in doubt.</p>
<h3>YAML configuration listed per item <a class="title-link" name="yaml-configuration-listed-per-item" href="https://www.home-assistant.io/integrations/mqtt/#yaml-configuration-listed-per-item"></a>
</h3>
<p>This method expects all items to be in a YAML list. Each item has a <code>{domain}</code> key and the item config is placed directly under the domain key. This method is considered as best practice. In all the examples we use this format.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">mqtt</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token punctuation">{</span>domain<span class="token punctuation">}</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">""</span>
      <span class="token punctuation">...</span>
  <span class="token punctuation">-</span> <span class="token punctuation">{</span>domain<span class="token punctuation">}</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">""</span>
      <span class="token punctuation">...</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h3>YAML configuration keyed and bundled by {domain} <a class="title-link" name="yaml-configuration-keyed-and-bundled-by-domain" href="https://www.home-assistant.io/integrations/mqtt/#yaml-configuration-keyed-and-bundled-by-domain"></a>
</h3>
<p>All items are grouped per <code>{domain}</code> and where all configs are listed.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">mqtt</span><span class="token punctuation">:</span>
  <span class="token punctuation">{</span>domain<span class="token punctuation">}</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">""</span>
      <span class="token punctuation">...</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">""</span>
      <span class="token punctuation">...</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>If you have a large number of manually configured items, you might want to consider <a href="https://www.home-assistant.io/docs/configuration/splitting_configuration/">splitting up the configuration</a>.</p>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:information-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Note</p>
  <p class="alert-content">
</p>
<p>Documentation on the MQTT components that support YAML <a href="https://www.home-assistant.io/integrations/mqtt/#configuration-via-yaml">can be found here</a>.</p>
  
</div>
<h2>Entity state updates <a class="title-link" name="entity-state-updates" href="https://www.home-assistant.io/integrations/mqtt/#entity-state-updates"></a>
</h2>
<p>Entities receive state updates via MQTT subscriptions. The payloads received on the state topics are processed to determine whether there is a significant change. If a change is detected, the entity will be updated.</p>
<p>Note that MQTT device payloads often contain information for updating multiple entities that subscribe to the same topics. For example, a light status update might include information about link quality. This data can update a link quality sensor but is not used to update the light itself. MQTT filters out entity state updates when there are no changes.</p>
<h3>The last reported state attribute <a class="title-link" name="the-last-reported-state-attribute" href="https://www.home-assistant.io/integrations/mqtt/#the-last-reported-state-attribute"></a>
</h3>
<p>Because MQTT state updates are often repeated frequently, even when no actual changes exist, it is up to the MQTT subscriber to determine whether a status update was received. If the latest update is missed, it might take some time before the next one arrives. If a retained payload exists at the broker, that value will be replayed first, but it will be an update of a previous last state.</p>
<p>MQTT devices often continuously generate numerous state updates. MQTT does not update <code>last_reported</code> to avoid impacting system stability unless <code>force_update</code> is set. Alternatively, an MQTT sensor can be created to measure the last update.</p>
<h2>Using Templates <a class="title-link" name="using-templates" href="https://www.home-assistant.io/integrations/mqtt/#using-templates"></a>
</h2>
<p>The MQTT integration supports templating. Read more <a href="https://www.home-assistant.io/docs/configuration/templating/#using-templates-with-the-mqtt-integration">about using templates with the MQTT integration</a>.</p>
<h3>Examples <a class="title-link" name="examples" href="https://www.home-assistant.io/integrations/mqtt/#examples"></a>
</h3>
<h4>REST API <a class="title-link" name="rest-api" href="https://www.home-assistant.io/integrations/mqtt/#rest-api"></a>
</h4>
<p>Using the <a href="https://developers.home-assistant.io/docs/api/rest/">REST API</a> to send a message to a given topic.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code data-lang="bash" class=" language-bash">$ <span class="token function">curl</span> -X POST <span class="token punctuation">\</span>
    -H <span class="token string">"Authorization: Bearer ABCDEFGH"</span> <span class="token punctuation">\</span>
    -H <span class="token string">"Content-Type: application/json"</span> <span class="token punctuation">\</span>
    -d <span class="token string">'{"payload": "Test message from HA", "topic": "home/notification"}'</span> <span class="token punctuation">\</span>
    <a class="token url-link" href="http://ip_address:8123/api/services/mqtt/publish">http://IP_ADDRESS:8123/api/services/mqtt/publish</a></code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h4>Automations <a class="title-link" name="automations" href="https://www.home-assistant.io/integrations/mqtt/#automations"></a>
</h4>
<p>Use as <a href="https://www.home-assistant.io/integrations/script/"><code>script</code></a> in automations.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">automation</span><span class="token punctuation">:</span>
  <span class="token key atrule">alias</span><span class="token punctuation">:</span> <span class="token string">"Send me a message when I get home"</span>
  <span class="token key atrule">triggers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">trigger</span><span class="token punctuation">:</span> state
      <span class="token key atrule">entity_id</span><span class="token punctuation">:</span> device_tracker.me
      <span class="token key atrule">to</span><span class="token punctuation">:</span> <span class="token string">"home"</span>
  <span class="token key atrule">actions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">action</span><span class="token punctuation">:</span> script.notify_mqtt
      <span class="token key atrule">data</span><span class="token punctuation">:</span>
        <span class="token key atrule">target</span><span class="token punctuation">:</span> <span class="token string">"me"</span>
        <span class="token key atrule">message</span><span class="token punctuation">:</span> <span class="token string">"I'm home"</span>

<span class="token key atrule">script</span><span class="token punctuation">:</span>
  <span class="token key atrule">notify_mqtt</span><span class="token punctuation">:</span>
    <span class="token key atrule">sequence</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">action</span><span class="token punctuation">:</span> mqtt.publish
        <span class="token key atrule">data</span><span class="token punctuation">:</span>
          <span class="token key atrule">payload</span><span class="token punctuation">:</span> <span class="token string">"{{ message }}"</span>
          <span class="token key atrule">topic</span><span class="token punctuation">:</span> home/"<span class="token punctuation">{</span><span class="token punctuation">{</span> target <span class="token punctuation">}</span><span class="token punctuation">}</span>"
          <span class="token key atrule">retain</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h2>Publish &amp; Dump actions <a class="title-link" name="publish--dump-actions" href="https://www.home-assistant.io/integrations/mqtt/#publish--dump-actions"></a>
</h2>
<p>The MQTT integration will register the <code>mqtt.publish</code> action, which allows publishing messages to MQTT topics.</p>
<h3>Action mqtt.publish <a class="title-link" name="action-mqttpublish" href="https://www.home-assistant.io/integrations/mqtt/#action-mqttpublish"></a>
</h3>
<table>
<thead>
<tr>
<th>Data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td>no</td>
<td>Topic to publish payload to.</td>
</tr>
<tr>
<td><code>payload</code></td>
<td>yes</td>
<td>Payload to publish. Will publish an empty payload when <code>payload</code> is omitted.</td>
</tr>
<tr>
<td><code>evaluate_payload</code></td>
<td>yes</td>
<td>If a <code>bytes</code> literal in <code>payload</code> should be evaluated to publish raw data. (default: false)</td>
</tr>
<tr>
<td><code>qos</code></td>
<td>yes</td>
<td>Quality of Service to use. (default: 0)</td>
</tr>
<tr>
<td><code>retain</code></td>
<td>yes</td>
<td>If message should have the retain flag set. (default: false)</td>
</tr>
</tbody>
</table>
<div class="alert alert-note">
  <p class="alert-title"><iconify-icon inline="" icon="mdi:information-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Note</p>
  <p class="alert-content">
</p>
<p>When <code>payload</code> is rendered from <a href="https://www.home-assistant.io/docs/configuration/templating/#using-templates-with-the-mqtt-integration">template</a> in a YAML script or automation, and the template renders to a <code>bytes</code> literal, the outgoing MQTT payload will only be sent as <code>raw</code> data, if the <code>evaluate_payload</code> option flag is set to <code>true</code>.</p>
  
</div>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">topic</span><span class="token punctuation">:</span> homeassistant/light/1/command
<span class="token key atrule">payload</span><span class="token punctuation">:</span> on</code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">topic</span><span class="token punctuation">:</span> homeassistant/light/1/state
<span class="token key atrule">payload</span><span class="token punctuation">:</span> <span class="token string">"{{ states('device_tracker.paulus') }}"</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">topic</span><span class="token punctuation">:</span> <span class="token string">"homeassistant/light/{{ states('sensor.light_active') }}/state"</span>
<span class="token key atrule">payload</span><span class="token punctuation">:</span> <span class="token string">"{{ states('device_tracker.paulus') }}"</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Be aware that <code>payload</code> must be a string.
If you want to send JSON using the YAML editor then you need to format/escape
it properly. Like:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">topic</span><span class="token punctuation">:</span> homeassistant/light/1/state
<span class="token key atrule">payload</span><span class="token punctuation">:</span> "<span class="token punctuation">{</span>\"Status\"<span class="token punctuation">:</span>\"off\"<span class="token punctuation">,</span> \"Data\"<span class="token punctuation">:</span>\"something\"<span class="token punctuation">}</span>"`</code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>The example below shows how to publish a temperature sensor ‘Bathroom Temperature’.
The <code>device_class</code> is set, so it is not needed to set the “name” option. The entity
will inherit the name from the <code>device_class</code> set and also support translations.
If you set “name” in the payload the entity name will start with the device name.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">action</span><span class="token punctuation">:</span> mqtt.publish
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">topic</span><span class="token punctuation">:</span> homeassistant/sensor/Acurite<span class="token punctuation">-</span>986<span class="token punctuation">-</span>1R<span class="token punctuation">-</span>51778/config
  <span class="token key atrule">payload</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token punctuation">-</span>
    <span class="token punctuation">{</span><span class="token key atrule">"device_class"</span><span class="token punctuation">:</span> <span class="token string">"temperature"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"unit_of_measurement"</span><span class="token punctuation">:</span> <span class="token string">"\u00b0C"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"value_template"</span><span class="token punctuation">:</span> <span class="token string">"{{ value|float }}"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"state_topic"</span><span class="token punctuation">:</span> <span class="token string">"rtl_433/rtl433/devices/Acurite-986/1R/51778/temperature_C"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"unique_id"</span><span class="token punctuation">:</span> <span class="token string">"Acurite-986-1R-51778-T"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"device"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token key atrule">"identifiers"</span><span class="token punctuation">:</span> <span class="token string">"Acurite-986-1R-51778"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"name"</span><span class="token punctuation">:</span> <span class="token string">"Bathroom"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"model"</span><span class="token punctuation">:</span> <span class="token string">"Acurite"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"model_id"</span><span class="token punctuation">:</span> <span class="token string">"986"</span><span class="token punctuation">,</span>
    <span class="token key atrule">"manufacturer"</span><span class="token punctuation">:</span> <span class="token string">"rtl_433"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<p>Example of how to use <code>qos</code> and <code>retain</code>:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">topic</span><span class="token punctuation">:</span> homeassistant/light/1/command
<span class="token key atrule">payload</span><span class="token punctuation">:</span> on
<span class="token key atrule">qos</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token key atrule">retain</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h3>Action mqtt.dump <a class="title-link" name="action-mqttdump" href="https://www.home-assistant.io/integrations/mqtt/#action-mqttdump"></a>
</h3>
<p>Listen to the specified topic matcher and dumps all received messages within a specific duration into the file <code>mqtt_dump.txt</code> in your configuration folder. This is useful when debugging a problem.</p>
<table>
<thead>
<tr>
<th>Data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td>no</td>
<td>Topic to dump. Can contain a wildcard (<code>#</code> or <code>+</code>).</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>yes</td>
<td>Duration in seconds that we will listen for messages. Default is 5 seconds.</td>
</tr>
</tbody>
</table>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token key atrule">topic</span><span class="token punctuation">:</span> zigbee2mqtt/<span class="token comment">#</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h2>Logging <a class="title-link" name="logging" href="https://www.home-assistant.io/integrations/mqtt/#logging"></a>
</h2>
<p>The <a href="https://www.home-assistant.io/integrations/logger/">logger</a> integration allows the logging of received MQTT messages.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-yaml"><code data-lang="yaml" class=" language-yaml"><span class="token comment"># Example configuration.yaml entry</span>
<span class="token key atrule">logger</span><span class="token punctuation">:</span>
  <span class="token key atrule">default</span><span class="token punctuation">:</span> warning
  <span class="token key atrule">logs</span><span class="token punctuation">:</span>
    <span class="token key atrule">homeassistant.components.mqtt</span><span class="token punctuation">:</span> debug</code></pre><div class="toolbar"><div class="toolbar-item"><span>YAML</span></div><div class="toolbar-item"><button>Copy</button></div></div></div></div></div>
<h2>Event event_mqtt_reloaded <a class="title-link" name="event-event_mqtt_reloaded" href="https://www.home-assistant.io/integrations/mqtt/#event-event_mqtt_reloaded"></a>
</h2>
<p>Event <code>event_mqtt_reloaded</code> is fired when Manually configured MQTT entities have been reloaded and entities thus might have changed.</p>
<p>This event has no additional data.</p>


  


  
<div class="material-card text feedback">
  <h4>
<iconify-icon inline="" icon="mdi:feedback" title="Feedback"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> <b> Help us improve our documentation</b><a href="https://www.home-assistant.io/integrations/mqtt/#feedback_section" class="title-link" name="feedback_section"></a>
</h4>
  Suggest an edit to this page, or provide/view feedback for this page.
  <div class="links">
    <a href="https://github.com/home-assistant/home-assistant.io/tree/current/source/_integrations/mqtt.markdown" target="_blank"><iconify-icon inline="" icon="mdi:edit"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Edit</a>
    
    <a href="https://github.com/home-assistant/home-assistant.io/issues/new?template=feedback.yml&amp;url=https%3A%2F%2Fwww.home-assistant.io%2Fintegrations%2Fmqtt%2F&amp;version=2025.3.2&amp;labels=current,integration%3A%20mqtt" target="_blank"><iconify-icon inline="" icon="mdi:comment-edit-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Provide feedback</a>
    <a href="https://github.com/home-assistant/home-assistant.io/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22integration%3A+mqtt%22" target="_blank"><iconify-icon inline="" icon="mdi:comment-text-multiple-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> View pending feedback</a>
    
  </div>
</div>


</article>

            
          </div>


          
            
              <aside id="integration-sidebar" class="grid__item one-third desk-wide-one-quarter lap-one-whole palm-one-whole">
              
            <div class="grid">
  




  


<section class="aside-module grid__item one-whole lap-one-half">
  <div class="brand-logo-container section">
      <img src="./MQTT - Home Assistant_files/logo.png" srcset="https://brands.home-assistant.io/_/mqtt/logo@2x.png 2x"><a href="https://my.home-assistant.io/redirect/config_flow_start?domain=mqtt" class="my badge" target="_blank"><img src="./MQTT - Home Assistant_files/config_flow_start.svg"></a></div>

  <div class="section">The MQTT  integration  was introduced in Home Assistant pre 0.7, and it's used by <a title="Open analytics.home-assistant.io" href="https://analytics.home-assistant.io/integrations" target="_blank" rel="noopener">
        
          44.5%</a> of the active installations.
        
      
    
  </div>
    <div class="section">
      <iconify-icon icon="mdi:upload-network-outline"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M15 20a1 1 0 0 0-1-1h-1v-2h4a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h4v2h-1a1 1 0 0 0-1 1H2v2h7a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1h7v-2zm-8-5V5h10v10zm5-9l-4 4h3v4h2v-4h3z"></path></svg></template></iconify-icon>&nbsp;Its IoT class is <a href="https://www.home-assistant.io/blog/2016/02/12/classifying-the-internet-of-things/#classifiers">Local Push.</a>
    </div>
  <div class="section">  
    <a href="https://www.home-assistant.io/docs/quality_scale/#-platinum">🏆 Platinum quality</a><br></div>
  <div class="section">
    <a href="https://github.com/home-assistant/core/tree/dev/homeassistant/components/mqtt" target="_blank"><iconify-icon inline="" icon="simple-icons:github" title="Github"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></template></iconify-icon> View source on GitHub</a><br>
    <a href="https://github.com/home-assistant/core/issues?q=is%3Aissue+is%3Aopen+label%3A%22integration%3A+mqtt%22" target="_blank"><iconify-icon inline="" icon="mdi:bug" title="Bug"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M14 12h-4v-2h4m0 6h-4v-2h4m6-6h-2.81a6 6 0 0 0-1.82-1.96L17 4.41L15.59 3l-2.17 2.17a6 6 0 0 0-2.83 0L8.41 3L7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20z"></path></svg></template></iconify-icon> View known issues</a>
  </div></section>

<section class="aside-module grid__item one-whole lap-one-half">
  <div class="section">
    <h1 class="title epsilon"><iconify-icon inline="" icon="mdi:person-heart" title="Person heart"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M15 14c-2.7 0-8 1.3-8 4v2h16v-2c0-2.7-5.3-4-8-4m0-2a4 4 0 0 0 4-4a4 4 0 0 0-4-4a4 4 0 0 0-4 4a4 4 0 0 0 4 4M5 15l-.6-.5C2.4 12.6 1 11.4 1 9.9c0-1.2 1-2.2 2.2-2.2c.7 0 1.4.3 1.8.8c.4-.5 1.1-.8 1.8-.8C8 7.7 9 8.6 9 9.9c0 1.5-1.4 2.7-3.4 4.6z"></path></svg></template></iconify-icon> Integration owners</h1>
    
        
        
        
          
          <div class="section">
            We are incredibly grateful to the following contributors who currently maintain this integration:<br>
          </div>
          <div class="section"><a href="https://github.com/emontnemery" target="_blank"><img class="codeowner-avatar" src="./MQTT - Home Assistant_files/emontnemery" alt="@emontnemery"> @emontnemery</a><br><a href="https://github.com/jbouwh" target="_blank"><img class="codeowner-avatar" src="./MQTT - Home Assistant_files/jbouwh" alt="@jbouwh"> @jbouwh</a><br><a href="https://github.com/bdraco" target="_blank"><img class="codeowner-avatar" src="./MQTT - Home Assistant_files/bdraco" alt="@bdraco"> @bdraco</a><br></div>
        
    
  </div>
</section>






  <section id="toc-module" class="aside-module grid__item one-whole lap-one-half">
        <div class="section">
          <h1 class="title epsilon"><iconify-icon inline="" icon="mdi:toc" title="Toc"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> On this page</h1>
          <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#removing-the-mqtt-integration">Removing the MQTT integration</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#setting-up-a-broker">Setting up a broker</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#broker-configuration">Broker configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#advanced-broker-configuration">Advanced broker configuration</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#configure-mqtt-options">Configure MQTT options</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#change-mqtt-discovery-options">Change MQTT discovery options</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-options">Discovery options</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#birth-and-last-will-messages">Birth and last will messages</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#testing-your-setup">Testing your setup</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#sharing-of-device-configuration">Sharing of device configuration</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#naming-of-mqtt-entities">Naming of MQTT Entities</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#mqtt-discovery">MQTT Discovery</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-messages">Discovery messages</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-messages-and-availability">Discovery messages and availability</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#using-availability-topics">Using Availability topics</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#discovery-examples-with-component-discovery">Discovery examples with component discovery</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#support-by-third-party-tools">Support by third-party tools</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#manual-configured-mqtt-items">Manual configured MQTT items</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#yaml-configuration-listed-per-item">YAML configuration listed per item</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#yaml-configuration-keyed-and-bundled-by-domain">YAML configuration keyed and bundled by {domain}</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#entity-state-updates">Entity state updates</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#the-last-reported-state-attribute">The last reported state attribute</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#using-templates">Using Templates</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#examples">Examples</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#publish--dump-actions">Publish &amp; Dump actions</a>
<ul>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#action-mqttpublish">Action mqtt.publish</a></li>
<li class="toc-entry toc-h3"><a href="https://www.home-assistant.io/integrations/mqtt/#action-mqttdump">Action mqtt.dump</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#logging">Logging</a></li>
<li class="toc-entry toc-h2"><a href="https://www.home-assistant.io/integrations/mqtt/#event-event_mqtt_reloaded">Event event_mqtt_reloaded</a></li>
</ul>
        </div>
      </section><section id="category-module" class="aside-module grid__item one-whole lap-one-half">
      <div class="section">
        <h1 class="title epsilon"><iconify-icon inline="" icon="mdi:category" title="Category"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon> Categories</h1>
        <ul class="divided"><li>
            <a href="https://www.home-assistant.io/integrations/#hub">Hub</a>
          </li><li>
            <a href="https://www.home-assistant.io/integrations/#update">Update</a>
          </li></ul>
      </div>
    </section></div>

          </aside>
          
        </div>
      </div>

      <footer>
        <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="skyline grid">
        <div class="skyline grid__item one-whole">
          <div class="footer-skyline">
          </div>
        </div>
      </div>
      <div class="footer-nav grid">
        <div class="company grid__item one-quarter lap-one-half palm-one-whole">
          <div class="title">
            <img src="./MQTT - Home Assistant_files/footer-logo-text.svg" height="72" alt="Home Assistant">
          </div>
          <p>
            Home Assistant is a project from the <a href="https://www.openhomefoundation.org/">Open Home Foundation</a>, sponsored by <a href="https://www.nabucasa.com/">Nabu Casa</a>.
          </p>
        </div>

        <div class="grid__item one-quarter lap-one-half palm-one-whole">
          <h3>Join us and contribute!</h3>
          <ul>
            <li><a class="external-link" href="https://github.com/home-assistant/">GitHub repo <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
            <li><a class="external-link" href="https://developers.home-assistant.io/">Developers Portal <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
            <li><a class="external-link" href="https://design.home-assistant.io/">Design Portal <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
            <li><a class="external-link" href="https://data.home-assistant.io/">Data Science Portal <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
            <li><a class="external-link" href="https://community.home-assistant.io/">Community Forum <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></li>
            <li><a href="https://www.home-assistant.io/help/reporting_issues/">Reporting issues</a></li>
            <li><a href="https://home-assistant-store.creator-spring.com/">Community Merch Store</a></li>
          </ul>
          <h3>System status</h3>
          <ul>
            <li>
              <a class="external-link" href="https://alerts.home-assistant.io/">Integration Alerts <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a>
            </li>
            <li><a href="https://www.home-assistant.io/security/">Security Alerts</a></li>
            <li>
              <a class="external-link" href="https://status.home-assistant.io/">System Status <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a>
            </li>
          </ul>
        </div>

        <div class="grid__item one-quarter lap-one-half palm-one-whole">
          <h3>Companion apps</h3>
          <ul>
            <li><a class="external-link" href="https://apps.apple.com/us/app/home-assistant/id1099568401">iOS and Apple devices</a></li>
            <li><a class="external-link" href="https://play.google.com/store/apps/details?id=io.homeassistant.companion.android">Android and Wear OS</a></li>
            <li><a class="external-link" href="https://companion.home-assistant.io/">...and more!</a></li>
          </ul>
          <h3>Governance</h3>
          <ul>
            <li><a href="https://www.home-assistant.io/privacy/">Privacy Notices</a></li>
            <li><a href="https://www.home-assistant.io/developers/cla/">Contributor License Agreement</a></li>
            <li><a href="https://www.home-assistant.io/tos/">Terms of Service</a></li>
            <li><a href="https://www.home-assistant.io/code_of_conduct/">Code of Conduct</a></li>
            <li><a href="https://www.home-assistant.io/developers/credits/">Credits</a></li>
            <li><a href="https://www.home-assistant.io/developers/license/">License</a></li>
          </ul>
        </div>

        <div class="socials grid__item one-quarter lap-one-half palm-one-whole">

          <h3>Follow us</h3>
          <p><a class="external-link" href="https://building.open-home.io/#/portal">Sign up for our newsletter <iconify-icon inline="" icon="tabler:external-link" title="External link"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:-0.125em}span,svg{display:block}</style></template></iconify-icon></a></p>
          <div class="icons">
            <a rel="me" href="https://youtube.com/@home_assistant" title="YouTube" target="_blank"><iconify-icon icon="simple-icons:youtube"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <a rel="me" href="https://reddit.com/r/homeassistant" title="Reddit" target="_blank"><iconify-icon icon="simple-icons:reddit"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <a rel="me" href="https://github.com/home-assistant/home-assistant" title="GitHub" target="_blank"><iconify-icon icon="simple-icons:github"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <br>
            <a rel="me" href="https://fosstodon.org/@homeassistant" title="Mastodon" target="_blank"><iconify-icon icon="simple-icons:mastodon"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <a rel="me" href="https://bsky.app/profile/home-assistant.io" title="Bluesky" target="_blank"><iconify-icon icon="simple-icons:bluesky"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <a rel="me" href="https://x.com/home_assistant" title="X" target="_blank"><iconify-icon icon="simple-icons:x"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <br>
            <a rel="me" href="https://www.facebook.com/homeassistantio" title="Facebook" target="_blank"><iconify-icon icon="simple-icons:facebook"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <a rel="me" href="https://www.instagram.com/homeassistant/" title="Instagram" target="_blank"><iconify-icon icon="simple-icons:instagram"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
            <a rel="me" href="https://www.linkedin.com/company/home-assistant" title="LinkedIn" target="_blank"><iconify-icon icon="simple-icons:linkedin"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block}</style></template></iconify-icon></a>
          </div>

          <div class="web-notice">
            <p>
              Contact us <a href="mailto:hello@home-assistant.io">here</a> for media and partnership inquiries. (No technical support!)
            </p>
            <p>
              Website powered by <a href="https://jekyllrb.com/">Jekyll</a><br>
              Originally based on the <a href="https://github.com/coogie/oscailte">Oscailte theme</a>
            </p>
            <a href="https://www.netlify.com/">
              <img src="./MQTT - Home Assistant_files/netlify.svg" alt="Deploys by Netlify Badge">
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

      </footer>

    </div>
    <script type="module" src="./MQTT - Home Assistant_files/lite-youtube.js.download"></script>

<script src="./MQTT - Home Assistant_files/terminology_tooltip.js.download" type="text/javascript" defer=""></script>

<script src="./MQTT - Home Assistant_files/prism.js.download" type="text/javascript" defer=""></script>
<script type="text/javascript" src="./MQTT - Home Assistant_files/index.min.js.download"></script>
<script type="text/javascript">
docsearch({
  container: '#docsearch',
  appId: 'FBHBYS3J0U',
  indexName: 'home-assistant',
  apiKey: "ba6f7e6d97b3d3d2f778978c742a47c6",
});
document.querySelector('.site-title').addEventListener('contextmenu', function(ev) {
  ev.preventDefault();
  document.location.assign("https://design.home-assistant.io/#brand/logo")
});
</script>




  <script defer="" src="./MQTT - Home Assistant_files/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;91eda51e1aebf662&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.1.0&quot;,&quot;token&quot;:&quot;5cecb750997f42328a45cbfc192e0673&quot;}" crossorigin="anonymous"></script>


</body></html>